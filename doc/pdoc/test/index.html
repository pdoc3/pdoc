<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.0" />
<title>pdoc.test API documentation</title>
<meta name="description" content="Unit tests for pdoc package." />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<style>.homelink{display:block;font-size:2em;font-weight:bold;color:#555;padding-bottom:.5em;border-bottom:1px solid silver}.homelink:hover{color:inherit}.homelink img{max-width:20%;max-height:5em;margin:auto;margin-bottom:.3em}</style>
<link rel="canonical" href="https://pdoc3.github.io/pdoc/doc/pdoc/test/">
<link rel="icon" href="https://pdoc.github.io/pdoc/logo.png">
<script data-ad-client="ca-pub-2900001379782823" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pdoc.test</code></h1>
</header>
<section id="section-intro">
<p>Unit tests for pdoc package.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L0-L1427" class="git-link">Browse git</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Unit tests for pdoc package.
&#34;&#34;&#34;
import enum
import inspect
import os
import shutil
import signal
import sys
import threading
import unittest
import warnings
from contextlib import contextmanager, redirect_stderr, redirect_stdout
from functools import wraps
from glob import glob
from io import StringIO
from itertools import chain
from random import randint
from tempfile import TemporaryDirectory
from time import sleep
from unittest.mock import patch
from urllib.error import HTTPError
from urllib.request import Request, urlopen

import typing

import pdoc
from pdoc import cli
from pdoc.html_helpers import (
    minify_css, minify_html, glimpse, to_html,
    ReferenceWarning, extract_toc, format_git_link,
)

TESTS_BASEDIR = os.path.abspath(os.path.dirname(__file__) or &#39;.&#39;)
EXAMPLE_MODULE = &#39;example_pkg&#39;

sys.path.insert(0, TESTS_BASEDIR)


@contextmanager
def temp_dir():
    with TemporaryDirectory(prefix=&#39;pdoc-test-&#39;) as path:
        yield path


@contextmanager
def chdir(path):
    old = os.getcwd()
    try:
        os.chdir(path)
        yield
    finally:
        os.chdir(old)


def run(*args, _check=True, **kwargs) -&gt; int:
    params = ((&#39;--&#39; + key.replace(&#39;_&#39;, &#39;-&#39;), value)
              for key, value in kwargs.items())
    params = list(filter(None, chain.from_iterable(params)))  # type: ignore
    _args = cli.parser.parse_args([*params, *args])           # type: ignore
    try:
        returncode = cli.main(_args)
        return returncode or 0
    except SystemExit as e:
        return e.code


@contextmanager
def run_html(*args, **kwargs):
    with temp_dir() as path:
        run(*args, html=None, output_dir=path, **kwargs)
        with chdir(path):
            yield


@contextmanager
def redirect_streams():
    stdout, stderr = StringIO(), StringIO()
    with redirect_stderr(stderr), redirect_stdout(stdout):
        yield stdout, stderr


def ignore_warnings(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        with warnings.catch_warnings():
            warnings.simplefilter(&#39;ignore&#39;)
            func(*args, **kwargs)
    return wrapper


class CliTest(unittest.TestCase):
    &#34;&#34;&#34;
    Command-line interface unit tests.
    &#34;&#34;&#34;
    ALL_FILES = [
        &#39;example_pkg&#39;,
        &#39;example_pkg/index.html&#39;,
        &#39;example_pkg/index.m.html&#39;,
        &#39;example_pkg/module.html&#39;,
        &#39;example_pkg/_private&#39;,
        &#39;example_pkg/_private/index.html&#39;,
        &#39;example_pkg/_private/module.html&#39;,
        &#39;example_pkg/subpkg&#39;,
        &#39;example_pkg/subpkg/_private.html&#39;,
        &#39;example_pkg/subpkg/index.html&#39;,
        &#39;example_pkg/subpkg2&#39;,
        &#39;example_pkg/subpkg2/_private.html&#39;,
        &#39;example_pkg/subpkg2/module.html&#39;,
        &#39;example_pkg/subpkg2/index.html&#39;,
    ]
    PUBLIC_FILES = [f for f in ALL_FILES if &#39;/_&#39; not in f]

    if os.name == &#39;nt&#39;:
        ALL_FILES = [i.replace(&#39;/&#39;, &#39;\\&#39;) for i in ALL_FILES]
        PUBLIC_FILES = [i.replace(&#39;/&#39;, &#39;\\&#39;) for i in PUBLIC_FILES]

    def setUp(self):
        pdoc.reset()

    def _basic_html_assertions(self, expected_files=PUBLIC_FILES):
        # Output directory tree layout is as expected
        files = glob(&#39;**&#39;, recursive=True)
        self.assertEqual(sorted(files), sorted(expected_files))

    def _check_files(self, include_patterns=(), exclude_patterns=(), file_pattern=&#39;**/*.html&#39;):
        files = glob(file_pattern, recursive=True)
        assert files
        for file in files:
            with open(file) as f:
                contents = f.read()
                for pattern in include_patterns:
                    self.assertIn(pattern, contents)
                for pattern in exclude_patterns:
                    self.assertNotIn(pattern, contents)

    def test_html(self):
        include_patterns = [
            &#39;a=&amp;lt;object&#39;,
            &#39;CONST docstring&#39;,
            &#39;var docstring&#39;,
            &#39;foreign_var&#39;,
            &#39;foreign var docstring&#39;,
            &#39;A&#39;,
            &#39;A.overridden docstring&#39;,
            &#39;A.overridden_same_docstring docstring&#39;,
            &#39;A.inherited&#39;,
            &#39;B docstring&#39;,
            &#39;B.overridden docstring&#39;,
            &#39;builtins.int&#39;,
            &#39;External refs: &#39;,
            &#39;&gt;sys.version&lt;&#39;,
            &#39;B.CONST docstring&#39;,
            &#39;B.var docstring&#39;,
            &#39;b=1&#39;,
            &#39;*args&#39;,
            &#39;**kwargs&#39;,
            &#39;x, y, z, w&#39;,
            &#39;instance_var&#39;,
            &#39;instance var docstring&#39;,
            &#39;B.f docstring&#39;,
            &#39;B.static docstring&#39;,
            &#39;B.cls docstring&#39;,
            &#39;B.p docstring&#39;,
            &#39;B.C docstring&#39;,
            &#39;B.overridden docstring&#39;,

            &#39;&lt;code&gt;__init__&lt;/code&gt; docstring&#39;,
            &#39; class=&#34;ident&#34;&gt;static&#39;,
        ]
        exclude_patterns = [
            &#39;&lt;object &#39;,
            &#39; class=&#34;ident&#34;&gt;_private&#39;,
            &#39; class=&#34;ident&#34;&gt;_Private&#39;,
            &#39;non_callable_routine&#39;,
        ]
        package_files = {
            &#39;&#39;: self.PUBLIC_FILES,
            &#39;.subpkg2&#39;: [f for f in self.PUBLIC_FILES
                         if &#39;subpkg2&#39; in f or f == EXAMPLE_MODULE],
            &#39;._private&#39;: [f for f in self.ALL_FILES
                          if EXAMPLE_MODULE + &#39;/_private&#39; in f or f == EXAMPLE_MODULE],
        }
        for package, expected_files in package_files.items():
            with self.subTest(package=package):
                with run_html(EXAMPLE_MODULE + package,
                              &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                              config=&#39;show_source_code=False&#39;):
                    self._basic_html_assertions(expected_files)
                    self._check_files(include_patterns, exclude_patterns)

        filenames_files = {
            (&#39;module.py&#39;,): [&#39;module.html&#39;],
            (&#39;module.py&#39;, &#39;subpkg2&#39;): [&#39;module.html&#39;, &#39;subpkg2&#39;,
                                       &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;],
        }
        with chdir(TESTS_BASEDIR):
            for filenames, expected_files in filenames_files.items():
                with self.subTest(filename=&#39;,&#39;.join(filenames)):
                    with run_html(*(os.path.join(EXAMPLE_MODULE, f) for f in filenames),
                                  &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                                  config=&#39;show_source_code=False&#39;):
                        self._basic_html_assertions(expected_files)
                        self._check_files(include_patterns, exclude_patterns)

    def test_html_multiple_files(self):
        with chdir(TESTS_BASEDIR):
            with run_html(EXAMPLE_MODULE + &#39;/module.py&#39;, EXAMPLE_MODULE + &#39;/subpkg2&#39;):
                self._basic_html_assertions(
                    [&#39;module.html&#39;, &#39;subpkg2&#39;, &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;])

    def test_html_identifier(self):
        for package in (&#39;&#39;, &#39;._private&#39;):
            with self.subTest(package=package), \
                    self.assertWarns(UserWarning) as cm:
                with run_html(EXAMPLE_MODULE + package, filter=&#39;A&#39;,
                              config=&#39;show_source_code=False&#39;):
                    self._check_files([&#39;A&#39;], [&#39;CONST&#39;, &#39;B docstring&#39;])
        self.assertIn(&#39;__pdoc__&#39;, cm.warning.args[0])

    def test_html_ref_links(self):
        with run_html(EXAMPLE_MODULE, config=&#39;show_source_code=False&#39;):
            self._check_files(
                file_pattern=EXAMPLE_MODULE + &#39;/index.html&#39;,
                include_patterns=[
                    &#39;href=&#34;#example_pkg.B&#34;&gt;&#39;,
                    &#39;href=&#34;#example_pkg.A&#34;&gt;&#39;,
                ],
            )

    def test_html_no_source(self):
        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, html_no_source=None):
            self._basic_html_assertions()
            self._check_files(exclude_patterns=[&#39;class=&#34;source&#34;&#39;, &#39;Hidden&#39;])

    def test_force(self):
        with run_html(EXAMPLE_MODULE):
            with redirect_streams() as (stdout, stderr):
                returncode = run(EXAMPLE_MODULE, _check=False, html=None, output_dir=os.getcwd())
                self.assertNotEqual(returncode, 0)
                self.assertNotEqual(stderr.getvalue(), &#39;&#39;)

            with redirect_streams() as (stdout, stderr):
                returncode = run(EXAMPLE_MODULE, html=None, force=None, output_dir=os.getcwd())
                self.assertEqual(returncode, 0)
                self.assertEqual(stderr.getvalue(), &#39;&#39;)

    def test_external_links(self):
        with run_html(EXAMPLE_MODULE):
            self._basic_html_assertions()
            self._check_files(exclude_patterns=[&#39;&lt;a href=&#34;/sys.version.ext&#34;&#39;])

        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, external_links=None):
            self._basic_html_assertions()
            self._check_files([&#39;&lt;a title=&#34;sys.version&#34; href=&#34;/sys.version.ext&#34;&#39;])

    def test_template_dir(self):
        old_tpl_dirs = pdoc.tpl_lookup.directories.copy()
        # Prevent loading incorrect template cached from prev runs
        pdoc.tpl_lookup._collection.clear()
        try:
            with run_html(EXAMPLE_MODULE, template_dir=TESTS_BASEDIR):
                self._basic_html_assertions()
                self._check_files([&#39;FOOBAR&#39;, &#39;/* Empty CSS */&#39;], [&#39;coding: utf-8&#39;])
        finally:
            pdoc.tpl_lookup.directories = old_tpl_dirs
            pdoc.tpl_lookup._collection.clear()

    def test_link_prefix(self):
        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, link_prefix=&#39;/foobar/&#39;):
            self._basic_html_assertions()
            self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])

    def test_text(self):
        include_patterns = [
            &#39;object_as_arg_default(*args, a=&lt;object &#39;,
            &#39;CONST docstring&#39;,
            &#39;var docstring&#39;,
            &#39;foreign_var&#39;,
            &#39;foreign var docstring&#39;,
            &#39;A&#39;,
            &#39;A.overridden docstring&#39;,
            &#39;A.overridden_same_docstring docstring&#39;,
            &#39;A.inherited&#39;,
            &#39;B docstring&#39;,
            &#39;B.overridden docstring&#39;,
            &#39;builtins.int&#39;,
            &#39;External refs: &#39;,
            &#39;sys.version&#39;,
            &#39;B.CONST docstring&#39;,
            &#39;B.var docstring&#39;,
            &#39;x, y, z, w&#39;,
            &#39;`__init__` docstring&#39;,
            &#39;instance_var&#39;,
            &#39;instance var docstring&#39;,
            &#39;b=1&#39;,
            &#39;*args&#39;,
            &#39;**kwargs&#39;,
            &#39;B.f docstring&#39;,
            &#39;B.static docstring&#39;,
            &#39;B.cls docstring&#39;,
            &#39;B.p docstring&#39;,
            &#39;C&#39;,
            &#39;B.overridden docstring&#39;,
        ]
        exclude_patterns = [
            &#39;_private&#39;,
            &#39;_Private&#39;,
            &#39;subprocess&#39;,
            &#39;Hidden&#39;,
            &#39;non_callable_routine&#39;,
        ]

        with self.subTest(package=EXAMPLE_MODULE):
            with redirect_streams() as (stdout, _):
                run(EXAMPLE_MODULE, config=&#39;show_type_annotations=False&#39;)
                out = stdout.getvalue()

            header = &#39;Module {}\n{:=&lt;{}}&#39;.format(EXAMPLE_MODULE, &#39;&#39;,
                                                 len(&#39;Module &#39;) + len(EXAMPLE_MODULE))
            self.assertIn(header, out)
            for pattern in include_patterns:
                self.assertIn(pattern, out)
            for pattern in exclude_patterns:
                self.assertNotIn(pattern, out)

        with chdir(TESTS_BASEDIR):
            for files in ((&#39;module.py&#39;,),
                          (&#39;module.py&#39;, &#39;subpkg2&#39;)):
                with self.subTest(filename=&#39;,&#39;.join(files)):
                    with redirect_streams() as (stdout, _):
                        run(*(os.path.join(EXAMPLE_MODULE, f) for f in files))
                        out = stdout.getvalue()
                    for f in files:
                        header = &#39;Module {}\n&#39;.format(os.path.splitext(f)[0])
                        self.assertIn(header, out)

    def test_text_identifier(self):
        with redirect_streams() as (stdout, _):
            run(EXAMPLE_MODULE, filter=&#39;A&#39;)
            out = stdout.getvalue()
        self.assertIn(&#39;A&#39;, out)
        self.assertIn(&#39;### Descendants\n\n    * example_pkg.B&#39;, out)
        self.assertNotIn(&#39;CONST&#39;, out)
        self.assertNotIn(&#39;B docstring&#39;, out)

    def test_pdf(self):
        with redirect_streams() as (stdout, stderr):
            run(&#39;pdoc&#39;, pdf=None)
            out = stdout.getvalue()
            err = stderr.getvalue()
        self.assertIn(&#39;pdoc3.github.io&#39;, out)
        self.assertIn(&#39;pandoc&#39;, err)

        self.assertIn(str(inspect.signature(pdoc.Doc.__init__)).replace(&#39;self, &#39;, &#39;&#39;),
                      out)

    def test_config(self):
        with run_html(EXAMPLE_MODULE, config=&#39;link_prefix=&#34;/foobar/&#34;&#39;):
            self._basic_html_assertions()
            self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])

    def test_output_text(self):
        with temp_dir() as path:
            run(EXAMPLE_MODULE, output_dir=path)
            with chdir(path):
                self._basic_html_assertions([file.replace(&#39;.html&#39;, &#39;.md&#39;)
                                             for file in self.PUBLIC_FILES])

    def test_google_analytics(self):
        expected = [&#39;google-analytics.com&#39;]
        with run_html(EXAMPLE_MODULE):
            self._check_files((), exclude_patterns=expected)
        with run_html(EXAMPLE_MODULE, config=&#39;google_analytics=&#34;UA-xxxxxx-y&#34;&#39;):
            self._check_files(expected)

    def test_relative_dir_path(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            with run_html(&#39;.&#39;):
                self._check_files(())


class ApiTest(unittest.TestCase):
    &#34;&#34;&#34;
    Programmatic/API unit tests.
    &#34;&#34;&#34;

    def setUp(self):
        pdoc.reset()

    def test_module(self):
        modules = {
            EXAMPLE_MODULE: (&#39;&#39;, (&#39;index&#39;, &#39;module&#39;, &#39;subpkg&#39;, &#39;subpkg2&#39;)),
            EXAMPLE_MODULE + &#39;.subpkg2&#39;: (&#39;.subpkg2&#39;, (&#39;subpkg2.module&#39;,)),
        }
        with chdir(TESTS_BASEDIR):
            for module, (name_suffix, submodules) in modules.items():
                with self.subTest(module=module):
                    m = pdoc.Module(module)
                    self.assertEqual(repr(m), &#34;&lt;Module &#39;{}&#39;&gt;&#34;.format(m.obj.__name__))
                    self.assertEqual(m.name, EXAMPLE_MODULE + name_suffix)
                    self.assertEqual(sorted(m.name for m in m.submodules()),
                                     [EXAMPLE_MODULE + &#39;.&#39; + m for m in submodules])

    def test_Module_find_class(self):
        class A:
            __module__ = None

        assert A.__module__ is None
        mod = pdoc.Module(pdoc)
        self.assertIsInstance(mod.find_class(pdoc.Doc), pdoc.Class)
        self.assertIsInstance(mod.find_class(A), pdoc.External)

    def test_import_filename(self):
        with patch.object(sys, &#39;path&#39;, [&#39;&#39;]), \
                chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            pdoc.import_module(&#39;index&#39;)

    def test_imported_once(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            pdoc.import_module(&#39;_imported_once.py&#39;)

    def test_namespace(self):
        # Test the three namespace types
        # https://packaging.python.org/guides/packaging-namespace-packages/#creating-a-namespace-package
        for i in range(1, 4):
            path = os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_namespace&#39;, str(i))
            with patch.object(sys, &#39;path&#39;, [os.path.join(path, &#39;a&#39;),
                                            os.path.join(path, &#39;b&#39;)]):
                mod = pdoc.Module(&#39;a.main&#39;)
                self.assertIn(&#39;D&#39;, mod.doc)

    def test_module_allsubmodules(self):
        m = pdoc.Module(EXAMPLE_MODULE + &#39;._private&#39;)
        self.assertEqual(sorted(m.name for m in m.submodules()),
                         [EXAMPLE_MODULE + &#39;._private.module&#39;])

    def test_instance_var(self):
        pdoc.reset()
        mod = pdoc.Module(EXAMPLE_MODULE)
        var = mod.doc[&#39;B&#39;].doc[&#39;instance_var&#39;]
        self.assertTrue(var.instance_var)

    def test_readonly_value_descriptors(self):
        pdoc.reset()
        mod = pdoc.Module(pdoc.import_module(EXAMPLE_MODULE))
        var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor&#39;]
        self.assertIsInstance(var, pdoc.Variable)
        self.assertTrue(var.instance_var)
        self.assertEqual(var.docstring, &#34;&#34;&#34;ro_value_descriptor docstring&#34;&#34;&#34;)
        self.assertTrue(var.source)

        var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor_no_doc&#39;]
        self.assertIsInstance(var, pdoc.Variable)
        self.assertTrue(var.instance_var)
        self.assertEqual(var.docstring, &#34;&#34;&#34;Read-only value descriptor&#34;&#34;&#34;)
        self.assertTrue(var.source)

    def test_class_variables_docstring_not_from_obj(self):
        class C:
            vars_dont = 0
            but_clss_have_doc = int

        with self.assertWarns(UserWarning):
            doc = pdoc.Class(&#39;C&#39;, pdoc.Module(&#39;pdoc&#39;), C)
        self.assertEqual(doc.doc[&#39;vars_dont&#39;].docstring, &#39;&#39;)
        self.assertIn(&#39;integer&#39;, doc.doc[&#39;but_clss_have_doc&#39;].docstring)

    def test_builtin_methoddescriptors(self):
        import parser
        with self.assertWarns(UserWarning):
            c = pdoc.Class(&#39;STType&#39;, pdoc.Module(parser), parser.STType)
        self.assertIsInstance(c.doc[&#39;compile&#39;], pdoc.Function)

    def test_refname(self):
        mod = EXAMPLE_MODULE + &#39;.&#39; + &#39;subpkg&#39;
        module = pdoc.Module(mod)
        var = module.doc[&#39;var&#39;]
        cls = module.doc[&#39;B&#39;]
        nested_cls = cls.doc[&#39;C&#39;]
        cls_var = cls.doc[&#39;var&#39;]
        method = cls.doc[&#39;f&#39;]

        self.assertEqual(pdoc.External(&#39;foo&#39;).refname, &#39;foo&#39;)
        self.assertEqual(module.refname, mod)
        self.assertEqual(var.refname, mod + &#39;.var&#39;)
        self.assertEqual(cls.refname, mod + &#39;.B&#39;)
        self.assertEqual(nested_cls.refname, mod + &#39;.B.C&#39;)
        self.assertEqual(cls_var.refname, mod + &#39;.B.var&#39;)
        self.assertEqual(method.refname, mod + &#39;.B.f&#39;)

        # Inherited method&#39;s refname points to class&#39; implicit copy
        pdoc.link_inheritance()
        self.assertEqual(cls.doc[&#39;inherited&#39;].refname, mod + &#39;.B.inherited&#39;)

    def test_qualname(self):
        module = pdoc.Module(EXAMPLE_MODULE)
        var = module.doc[&#39;var&#39;]
        cls = module.doc[&#39;B&#39;]
        nested_cls = cls.doc[&#39;C&#39;]
        cls_var = cls.doc[&#39;var&#39;]
        method = cls.doc[&#39;f&#39;]

        self.assertEqual(pdoc.External(&#39;foo&#39;).qualname, &#39;foo&#39;)
        self.assertEqual(module.qualname, EXAMPLE_MODULE)
        self.assertEqual(var.qualname, &#39;var&#39;)
        self.assertEqual(cls.qualname, &#39;B&#39;)
        self.assertEqual(nested_cls.qualname, &#39;B.C&#39;)
        self.assertEqual(cls_var.qualname, &#39;B.var&#39;)
        self.assertEqual(method.qualname, &#39;B.f&#39;)

    def test__pdoc__dict(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A&#39;, mod.doc)
            self.assertNotIn(&#39;B&#39;, mod.doc)

        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.f&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;B&#39;, mod.doc)
            self.assertNotIn(&#39;f&#39;, mod.doc[&#39;B&#39;].doc)
            self.assertIsInstance(mod.find_ident(&#39;B.f&#39;), pdoc.External)

        # GH-125: https://github.com/pdoc3/pdoc/issues/125
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.inherited&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertNotIn(&#39;inherited&#39;, mod.doc[&#39;B&#39;].doc)

        # GH-99: https://github.com/pdoc3/pdoc/issues/99
        module = pdoc.import_module(EXAMPLE_MODULE + &#39;._exclude_dir&#39;)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;downloaded_modules&#39;: False}, create=True):
            mod = pdoc.Module(module)
            self.assertNotIn(&#39;downloaded_modules&#39;, mod.doc)

    def test__pdoc__invalid_value(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: 1}), \
                self.assertRaises(ValueError):
            pdoc.Module(module)
            pdoc.link_inheritance()

    def test__pdoc__whitelist(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;A&#39;].doc)
        self.assertNotIn(&#39;_private_function&#39;, mod.doc)

        # Override docstring string
        docstring = &#34;Overwrite private function doc&#34;
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;A.__call__&#39;: docstring}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertEqual(mod.doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring, docstring)

        # Module-relative
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private_function&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;Private function&#39;, mod.doc[&#39;_private_function&#39;].docstring)
            self.assertNotIn(&#39;_private_function&#39;, mod.doc[&#34;subpkg&#34;].doc)

        # Defined in example_pkg, referring to a member of its submodule
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;subpkg.A.__call__&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

        # Using full refname
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg.subpkg.A.__call__&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

        # Entire module, absolute refname
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg._private&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;module&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

        # Entire module, relative
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;_private&#39;, mod.doc)
            self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

        # Private instance variables
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B._private_instance_var&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;should be private&#39;, mod.doc[&#39;B&#39;].doc[&#39;_private_instance_var&#39;].docstring)

    def test__all__(self):
        module = pdoc.import_module(EXAMPLE_MODULE + &#39;.index&#39;)
        with patch.object(module, &#39;__all__&#39;, [&#39;B&#39;], create=True):
            mod = pdoc.Module(module)
            with self.assertWarns(UserWarning):  # Only B is used but __pdoc__ contains others
                pdoc.link_inheritance()
            self.assertEqual(list(mod.doc.keys()), [&#39;B&#39;])

    def test_find_ident(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.Module)
        mod = pdoc.Module(pdoc)
        self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.External)

        self.assertIsInstance(mod.find_ident(EXAMPLE_MODULE + &#39;.subpkg&#39;), pdoc.Module)

        nonexistent = &#39;foo()&#39;
        result = mod.find_ident(nonexistent)
        self.assertIsInstance(result, pdoc.External)
        self.assertEqual(result.name, nonexistent)

        # Ref by class __init__
        mod = pdoc.Module(pdoc)
        self.assertIs(mod.find_ident(&#39;pdoc.Doc.__init__&#39;).obj, pdoc.Doc)

    def test_inherits(self):
        module = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()

        a = module.doc[&#39;A&#39;]
        b = module.doc[&#39;B&#39;]
        self.assertEqual(b.doc[&#39;inherited&#39;].inherits,
                         a.doc[&#39;inherited&#39;])
        self.assertEqual(b.doc[&#39;overridden_same_docstring&#39;].inherits,
                         a.doc[&#39;overridden_same_docstring&#39;])
        self.assertEqual(b.doc[&#39;overridden&#39;].inherits,
                         None)

        c = module.doc[&#39;C&#39;]
        d = module.doc[&#39;D&#39;]
        self.assertEqual(d.doc[&#39;overridden&#39;].inherits, c.doc[&#39;overridden&#39;])
        self.assertEqual(c.doc[&#39;overridden&#39;].inherits, b.doc[&#39;overridden&#39;])

    def test_inherited_members(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()
        a = mod.doc[&#39;A&#39;]
        b = mod.doc[&#39;B&#39;]
        self.assertEqual(b.inherited_members(), [(a, [a.doc[&#39;inherited&#39;],
                                                      a.doc[&#39;overridden_same_docstring&#39;]])])
        self.assertEqual(a.inherited_members(), [])

    @ignore_warnings
    def test_subclasses(self):
        class A:
            pass

        class B(type):
            pass

        class C(A):
            pass

        class D(B):
            pass

        class G(C):
            pass

        class F(C):
            pass

        class E(C):
            pass

        mod = pdoc.Module(pdoc)
        self.assertEqual([x.refname for x in pdoc.Class(&#39;A&#39;, mod, A).subclasses()],
                         [mod.find_class(C).refname])
        self.assertEqual([x.refname for x in pdoc.Class(&#39;B&#39;, mod, B).subclasses()],
                         [mod.find_class(D).refname])
        self.assertEqual([x.refname for x in pdoc.Class(&#39;C&#39;, mod, C).subclasses()],
                         [mod.find_class(x).refname for x in (E, F, G)])

    def test_link_inheritance(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        with warnings.catch_warnings(record=True) as w:
            pdoc.link_inheritance()
            pdoc.link_inheritance()
        self.assertFalse(w)

        mod._is_inheritance_linked = False
        with self.assertWarns(UserWarning):
            pdoc.link_inheritance()

        # Test inheritance across modules
        pdoc.reset()
        mod = pdoc.Module(EXAMPLE_MODULE + &#39;._test_linking&#39;)
        pdoc.link_inheritance()
        a = mod.doc[&#39;a&#39;].doc[&#39;A&#39;]
        b = mod.doc[&#39;b&#39;].doc[&#39;B&#39;]
        c = mod.doc[&#39;b&#39;].doc[&#39;c&#39;].doc[&#39;C&#39;]
        self.assertEqual(b.doc[&#39;a&#39;].inherits, a.doc[&#39;a&#39;])
        self.assertEqual(b.doc[&#39;c&#39;].inherits, c.doc[&#39;c&#39;])
        # While classes do inherit from superclasses, they just shouldn&#39;t always
        # say so, because public classes do want to be exposed and linked to
        self.assertNotEqual(b.inherits, a)

    def test_context(self):
        context = {}
        pdoc.Module(pdoc, context=context)
        self.assertIn(&#39;pdoc&#39;, context)
        self.assertIn(&#39;pdoc.cli&#39;, context)
        self.assertIn(&#39;pdoc.cli.main&#39;, context)
        self.assertIn(&#39;pdoc.Module&#39;, context)
        self.assertIsInstance(context[&#39;pdoc&#39;], pdoc.Module)
        self.assertIsInstance(context[&#39;pdoc.cli&#39;], pdoc.Module)
        self.assertIsInstance(context[&#39;pdoc.cli.main&#39;], pdoc.Function)
        self.assertIsInstance(context[&#39;pdoc.Module&#39;], pdoc.Class)

        module = pdoc.Module(pdoc)
        self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.Class)
        pdoc.reset()
        self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.External)

    def test_Function_params(self):
        mod = pdoc.Module(pdoc)
        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, _a, _b=None: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;_a&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda _ok, a, _a, *args, _b=None, c=None, _d=None: None)
        self.assertEqual(func.params(), [&#39;_ok&#39;, &#39;a&#39;, &#39;_a&#39;, &#39;*args&#39;, &#39;c=None&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, b, *, _c=1: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;b&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, *, b, c: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;*&#39;, &#39;b&#39;, &#39;c&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a=os.environ, b=sys.stdout: None)
        self.assertEqual(func.params(), [&#39;a=os.environ&#39;, &#39;b=sys.stdout&#39;])

        class Foo(enum.Enum):
            a, b = 1, 2
        func = pdoc.Function(&#39;f&#39;, mod, lambda a=Foo.a: None)
        self.assertEqual(func.params(), [&#39;a=Foo.a&#39;])

        func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
        self.assertEqual(func.params(), [&#39;a=&lt;object object&gt;&#39;])

        func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
        self.assertEqual(func.params(link=lambda x: &#39;&#39;), [&#39;a=&amp;lt;object object&amp;gt;&#39;])

        # typed
        def f(a: int, *b, c: typing.List[pdoc.Doc] = []): pass
        func = pdoc.Function(&#39;f&#39;, mod, f)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;*b&#39;, &#34;c=[]&#34;])
        self.assertEqual(func.params(annotate=True),
                         [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;, &#34;c:\N{NBSP}List[pdoc.Doc]\N{NBSP}=\N{NBSP}[]&#34;])

        # typed, linked
        def link(dobj):
            return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=mod), dobj.qualname)

        self.assertEqual(func.params(annotate=True, link=link),
                         [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;,
                          &#34;c:\N{NBSP}List[&lt;a href=\&#34;#pdoc.Doc\&#34;&gt;Doc&lt;/a&gt;]\N{NBSP}=\N{NBSP}[]&#34;])

        # shadowed name
        def f(pdoc: int): pass
        func = pdoc.Function(&#39;f&#39;, mod, f)
        self.assertEqual(func.params(annotate=True, link=link), [&#39;pdoc:\N{NBSP}int&#39;])

        def bug130_str_annotation(a: &#34;str&#34;):
            return

        self.assertEqual(pdoc.Function(&#39;bug130&#39;, mod, bug130_str_annotation).params(annotate=True),
                         [&#39;a:\N{NBSP}str&#39;])

        # builtin callables with signatures in docstrings
        from itertools import repeat
        self.assertEqual(pdoc.Function(&#39;repeat&#39;, mod, repeat).params(), [&#39;object&#39;, &#39;times&#39;])
        self.assertEqual(pdoc.Function(&#39;slice&#39;, mod, slice).params(), [&#39;start&#39;, &#39;stop&#39;, &#39;step&#39;])

        class get_sample(repeat):
            &#34;&#34;&#34; get_sample(self: pdoc.int, pos: int) -&gt; Tuple[int, float] &#34;&#34;&#34;
        self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).params(annotate=True),
                         [&#39;self:\xa0int&#39;, &#39;pos:\xa0int&#39;])
        self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).return_annotation(),
                         &#39;Tuple[int,\xa0float]&#39;)

    def test_Function_return_annotation(self):
        import typing

        def f() -&gt; typing.List[typing.Union[str, pdoc.Doc]]: pass
        func = pdoc.Function(&#39;f&#39;, pdoc.Module(pdoc), f)
        self.assertEqual(func.return_annotation(), &#39;List[Union[str,\N{NBSP}pdoc.Doc]]&#39;)

    @ignore_warnings
    def test_Variable_type_annotation(self):
        import typing

        class Foobar:
            @property
            def prop(self) -&gt; typing.Optional[int]:
                pass

        mod = pdoc.Module(pdoc)
        cls = pdoc.Class(&#39;Foobar&#39;, mod, Foobar)
        self.assertEqual(cls.doc[&#39;prop&#39;].type_annotation(), &#39;Union[int,\N{NBSP}NoneType]&#39;)

    @ignore_warnings
    @unittest.skipIf(sys.version_info &lt; (3, 6), &#39;variable annotation unsupported in &lt;Py3.6&#39;)
    def test_Variable_type_annotation_py35plus(self):
        exec(&#39;&#39;&#39;class Foo:
                    var: int = 3
                    &#34;&#34;&#34;var&#34;&#34;&#34;
        &#39;&#39;&#39;)
        mod = pdoc.Module(pdoc)
        cls = pdoc.Class(&#39;Foobar&#39;, mod, locals()[&#39;Foo&#39;])
        self.assertEqual(cls.doc[&#39;var&#39;].type_annotation(), &#39;int&#39;)

    @ignore_warnings
    def test_Class_docstring(self):
        class A:
            &#34;&#34;&#34;foo&#34;&#34;&#34;

        class B:
            def __init__(self):
                &#34;&#34;&#34;foo&#34;&#34;&#34;

        class C:
            &#34;&#34;&#34;foo&#34;&#34;&#34;

            def __init__(self):
                &#34;&#34;&#34;bar&#34;&#34;&#34;

        class D(C):
            &#34;&#34;&#34;baz&#34;&#34;&#34;

        class E(C):
            def __init__(self):
                &#34;&#34;&#34;baz&#34;&#34;&#34;

        mod = pdoc.Module(pdoc)
        self.assertEqual(pdoc.Class(&#39;A&#39;, mod, A).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;B&#39;, mod, B).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).docstring, &#34;&#34;&#34;foo\n\nbar&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;D&#39;, mod, D).docstring, &#34;&#34;&#34;baz\n\nbar&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;E&#39;, mod, E).docstring, &#34;&#34;&#34;foo\n\nbaz&#34;&#34;&#34;)

    @ignore_warnings
    def test_Class_params(self):
        class C:
            def __init__(self, x):
                pass

        mod = pdoc.Module(pdoc)
        self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [&#39;x&#39;])
        with patch.dict(mod.obj.__pdoc__, {&#39;C.__init__&#39;: False}):
            self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [])

        # test case for https://github.com/pdoc3/pdoc/issues/124
        class C2:
            __signature__ = inspect.signature(lambda a, b, c=None, *, d=1, e: None)

        self.assertEqual(pdoc.Class(&#39;C2&#39;, mod, C2).params(), [&#39;a&#39;, &#39;b&#39;, &#39;c=None&#39;, &#39;*&#39;, &#39;d=1&#39;, &#39;e&#39;])

    def test_url(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()

        c = mod.doc[&#39;D&#39;]
        self.assertEqual(c.url(), &#39;example_pkg/index.html#example_pkg.D&#39;)
        self.assertEqual(c.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D&#39;)
        self.assertEqual(c.url(relative_to=c.module), &#39;#example_pkg.D&#39;)
        self.assertEqual(c.url(top_ancestor=True), c.url())  # Public classes do link to themselves

        f = c.doc[&#39;overridden&#39;]
        self.assertEqual(f.url(), &#39;example_pkg/index.html#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(relative_to=c.module), &#39;#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(top_ancestor=1), &#39;example_pkg/index.html#example_pkg.B.overridden&#39;)

    @unittest.skipIf(sys.version_info &lt; (3, 6), reason=&#34;only deterministic on CPython 3.6+&#34;)
    def test_sorting(self):
        module = pdoc.Module(EXAMPLE_MODULE)

        sorted_variables = module.variables()
        unsorted_variables = module.variables(sort=False)
        self.assertNotEqual(sorted_variables, unsorted_variables)
        self.assertEqual(sorted_variables, sorted(unsorted_variables))

        sorted_functions = module.functions()
        unsorted_functions = module.functions(sort=False)
        self.assertNotEqual(sorted_functions, unsorted_functions)
        self.assertEqual(sorted_functions, sorted(unsorted_functions))

        sorted_classes = module.classes()
        unsorted_classes = module.classes(sort=False)
        self.assertNotEqual(sorted_classes, unsorted_classes)
        self.assertEqual(sorted_classes, sorted(unsorted_classes))

        cls = module.doc[&#34;Docformats&#34;]

        sorted_methods = cls.methods()
        unsorted_methods = cls.methods(sort=False)
        self.assertNotEqual(sorted_methods, unsorted_methods)
        self.assertEqual(sorted_methods, sorted(unsorted_methods))

    def test_module_init(self):
        mod = pdoc.Module(&#39;pdoc.__init__&#39;)
        self.assertEqual(mod.name, &#39;pdoc&#39;)
        self.assertIn(&#39;Module&#39;, mod.doc)


class HtmlHelpersTest(unittest.TestCase):
    &#34;&#34;&#34;
    Unit tests for helper functions for producing HTML.
    &#34;&#34;&#34;

    def test_minify_css(self):
        css = &#39;a { color: white; } /*comment*/ b {;}&#39;
        minified = minify_css(css)
        self.assertNotIn(&#39; &#39;, minified)
        self.assertNotIn(&#39;;}&#39;, minified)
        self.assertNotIn(&#39;*&#39;, minified)

    def test_minify_html(self):
        html = &#39;  &lt;p&gt;   a   &lt;/p&gt;    &lt;pre&gt;    a\n    b&lt;/pre&gt;    c   \n    d   &#39;
        expected = &#39;\n&lt;p&gt;\na\n&lt;/p&gt;\n&lt;pre&gt;    a\n    b&lt;/pre&gt;\nc\nd\n&#39;
        minified = minify_html(html)
        self.assertEqual(minified, expected)

    def test_glimpse(self):
        text = &#39;foo bar\n\nbaz&#39;
        self.assertEqual(glimpse(text), &#39;foo bar …&#39;)
        self.assertEqual(glimpse(text, max_length=8, paragraph=False), &#39;foo …&#39;)
        self.assertEqual(glimpse(&#39;Foo bar\n-------&#39;), &#39;Foo bar&#39;)

    def test_to_html(self):
        text = &#39;&#39;&#39;# Title

`pdoc.Module` is a `Doc`, not `dict`.

ref with underscore: `_x_x_`

```
code block
```
reference: `package.foo`
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h1 id=&#34;title&#34;&gt;Title&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Module&#34;&gt;Module&lt;/a&gt;&lt;/code&gt; is a &lt;code&gt;&lt;a href=&#34;#pdoc.Doc&#34;&gt;Doc&lt;/a&gt;&lt;/code&gt;,\
 not &lt;code&gt;dict&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ref with underscore: &lt;code&gt;&lt;a href=&#34;#pdoc._x_x_&#34;&gt;_x_x_&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;code block
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;reference: &lt;code&gt;&lt;a href=&#34;/package.foo.ext&#34;&gt;package.foo&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;&#39;&#39;

        module = pdoc.Module(pdoc)
        module.doc[&#39;_x_x_&#39;] = pdoc.Variable(&#39;_x_x_&#39;, module, &#39;&#39;)

        def link(dobj):
            return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=module), dobj.qualname)

        html = to_html(text, module=module, link=link)
        self.assertEqual(html, expected)

        self.assertEqual(to_html(&#39;`pdoc.Doc.url()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Doc.url&#34;&gt;Doc.url&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)

        self.assertEqual(to_html(&#39;`foo.f()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;/foo.f().ext&#34;&gt;foo.f()&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)

    def test_to_html_refname(self):
        text = &#39;&#39;&#39;
[`pdoc` x][pdoc] `pdoc`
[x `pdoc`][pdoc] `[pdoc]()`

`__x__`

[`pdoc`](#)
[``pdoc` ``](#)
[```pdoc```](#)

```
pdoc
```

[pdoc]: #pdoc
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;\
&lt;p&gt;&lt;a href=&#34;#pdoc&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt; x&lt;/a&gt; &lt;code&gt;&lt;a&gt;pdoc&lt;/a&gt;&lt;/code&gt;
&lt;a href=&#34;#pdoc&#34;&gt;x &lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt; &lt;code&gt;[&lt;a&gt;pdoc&lt;/a&gt;]()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;__x__&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc`&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pdoc
&lt;/code&gt;&lt;/pre&gt;\
&#39;&#39;&#39;

        def link(dobj):
            return &#39;&lt;a&gt;{}&lt;/a&gt;&#39;.format(dobj.qualname)

        html = to_html(text, module=pdoc.Module(pdoc), link=link)
        self.assertEqual(html, expected)

    def test_to_html_refname_warning(self):
        mod = pdoc.Module(EXAMPLE_MODULE)

        def f():
            &#34;&#34;&#34;Reference to some `example_pkg.nonexisting` object&#34;&#34;&#34;

        mod.doc[&#39;__f&#39;] = pdoc.Function(&#39;__f&#39;, mod, f)
        with self.assertWarns(ReferenceWarning) as cm:
            mod.html()
        del mod.doc[&#39;__f&#39;]
        self.assertIn(&#39;example_pkg.nonexisting&#39;, cm.warning.args[0])

    def test_extract_toc(self):
        text = &#39;xxx\n\n# Title\n\nfoo\n\n## Subtitle\n\nbar&#39;
        expected = &#39;&#39;&#39;&lt;div class=&#34;toc&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#title&#34;&gt;Title&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#subtitle&#34;&gt;Subtitle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&#39;&#39;&#39;
        toc = extract_toc(text)
        self.assertEqual(toc, expected)

    @unittest.skipIf(shutil.which(&#34;git&#34;) is None or not os.path.exists(&#39;.git&#39;),
                     &#34;git not installed or we&#39;re not within git repo&#34;)
    def test_format_git_link(self):
        url = format_git_link(
            template=&#39;https://github.com/pdoc3/pdoc/blob/{commit}/{path}#L{start_line}-L{end_line}&#39;,
            dobj=pdoc.Module(EXAMPLE_MODULE).find_ident(&#39;module.foo&#39;),
        )
        self.assertRegex(url, r&#34;https://github.com/pdoc3/pdoc/blob/[0-9a-f]{40}&#34;
                              r&#34;/pdoc/test/example_pkg/module.py#L\d+-L\d+&#34;)


class Docformats(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls._module = pdoc.Module(pdoc)
        cls._docmodule = pdoc.import_module(EXAMPLE_MODULE)

    @staticmethod
    def _link(dobj, *args, **kwargs):
        return &#39;&lt;a&gt;{}&lt;/a&gt;&#39;.format(dobj.refname)

    def test_numpy(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Documentation&lt;/strong&gt;: &lt;a href=&#34;https://pdoc3.github.io/pdoc/doc/pdoc/&#34;&gt;https://pdoc3.github.io/pdoc/doc/pdoc/&lt;/a&gt;
&lt;strong&gt;Source Code&lt;/strong&gt;: &lt;a href=&#34;https://github.com/pdoc3/&#34;&gt;https://github.com/pdoc3/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x1&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;x2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;array_like&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;Input arrays,
description of &lt;code&gt;x1&lt;/code&gt;, &lt;code&gt;x2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;1.5.0&lt;/p&gt;
&lt;/div&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;{ NoneType, &#39;B&#39;, &#39;C&#39; }&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;n&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt; or &lt;code&gt;list&lt;/code&gt; of &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of num&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;**kwargs&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;Passed on.&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;complex&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;Union[Set[&lt;a&gt;pdoc.Doc&lt;/a&gt;, &lt;a&gt;pdoc.Function&lt;/a&gt;], &lt;a&gt;pdoc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The &lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;s of the new signal.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;output&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;foo&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;When something.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises_1&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;p&gt;None.&lt;/p&gt;
&lt;h2 id=&#34;invalid&#34;&gt;Invalid&lt;/h2&gt;
&lt;p&gt;no match&lt;/p&gt;
&lt;h2 id=&#34;see-also&#34;&gt;See Also&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;fromstring&lt;/code&gt;, &lt;code&gt;loadtxt&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;see-also_1&#34;&gt;See Also&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.text&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Function a with its description.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;scipy.random.norm&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Random variates, PDFs, etc.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;A class description that spans several lines.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;notes&#34;&gt;Notes&lt;/h2&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;
&lt;h3 id=&#34;h3-title&#34;&gt;H3 Title&lt;/h3&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.numpy)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_numpy_curly_brace_expansion(self):
        # See: https://github.com/mwaskom/seaborn/blob/66191d8a179f1bfa42f03749bc4a07e1c0c08156/seaborn/regression.py#L514  # noqa: 501
        text = &#39;&#39;&#39;Parameters
----------
prefix_{x,y}_partial : str
    some description
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;prefix_{x,y}_partial&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;some description&lt;/dd&gt;
&lt;/dl&gt;&#39;&#39;&#39;
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_google(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.
Nomatch:&lt;/p&gt;
&lt;h2 id=&#34;args&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;Text1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;List[str]&lt;/code&gt;, optional,\
 default=&lt;code&gt;10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Text2&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;args_1&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt; or &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg2&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;test_sequence&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;2-dim numpy array of real numbers, size: N * D
- the test observation sequence.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;test_sequence =
code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Continue.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;passed around&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;issue_10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;description didn&#39;t work across multiple lines
if only a single item was listed. &lt;code&gt;&lt;a&gt;inspect.cleandoc()&lt;/a&gt;&lt;/code&gt;
somehow stripped the required extra indentation.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;Dict[int, &lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;AttributeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;The &lt;code&gt;Raises&lt;/code&gt; section is a list of all exceptions
that are relevant to the interface.&lt;/p&gt;
&lt;p&gt;and a third line.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;ValueError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;If &lt;code&gt;arg2&lt;/code&gt; is equal to &lt;code&gt;arg1&lt;/code&gt;.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Test a title without a blank line before it.&lt;/p&gt;
&lt;h2 id=&#34;args_2&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;A&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;a&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;p&gt;Examples in doctest format.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; a = [1,2,3]
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;todos&#34;&gt;Todos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;For module TODOs&lt;/li&gt;
&lt;/ul&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.google)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_doctests(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Need an intro paragrapgh.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; Then code is indented one level
line1
line2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Alternatively&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; doctest
fenced code works
always
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; nbytes(100)
&#39;100.0 bytes&#39;
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;some text&lt;/p&gt;
&lt;p&gt;some text&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; another doctest
line1
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;example&#34;&gt;Example&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; f()
Traceback (most recent call last):
    ...
Exception: something went wrong
&lt;/code&gt;&lt;/pre&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.doctests)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_reST_directives(self):
        expected = &#39;&#39;&#39;&lt;div class=&#34;admonition todo&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;TODO&lt;/p&gt;
&lt;p&gt;Create something.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition admonition&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Example&lt;/p&gt;
&lt;p&gt;Image shows something.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;admonition note&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Note&lt;/p&gt;
&lt;p&gt;Can only nest admonitions two levels.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now you know.&lt;/p&gt;
&lt;div class=&#34;admonition warning&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Warning&lt;/p&gt;
&lt;p&gt;Some warning
lines.&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Describe some func in a list
  across multiple lines:&lt;/p&gt;
&lt;div class=&#34;admonition deprecated&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Deprecated since version:&amp;ensp;3.1&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;spam&lt;/code&gt; instead.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;2.5&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;spam&lt;/em&gt; parameter.&lt;/p&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;admonition caution&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Caution&lt;/p&gt;
&lt;p&gt;Don&#39;t touch this!&lt;/p&gt;
&lt;/div&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.reST_directives)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_reST_include(self):
        expected = &#39;&#39;&#39;&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;    x = 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1
x = 2
x = 3
x =&lt;/p&gt;&#39;&#39;&#39;
        mod = pdoc.Module(pdoc.import_module(
            os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_reST_include&#39;, &#39;test.py&#39;)))
        text = inspect.getdoc(mod.obj)
        html = to_html(text, module=mod)
        self.assertEqual(html, expected)

        # Ensure includes are resolved within docstrings already,
        # e.g. for `pdoc.html_helpers.extract_toc()` to work
        self.assertIn(&#39;Command-line interface&#39;,
                      pdoc.Module(pdoc).docstring)

    def test_urls(self):
        text = &#34;&#34;&#34;Beautiful Soup
http://www.foo.bar
http://www.foo.bar?q=&#34;foo&#34;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;https://foo.bar&gt;

Work [like this](http://foo/) and [like that].

[like that]: ftp://bar

data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D

```
http://url.com
```&#34;&#34;&#34;
        expected = &#34;&#34;&#34;&lt;p&gt;Beautiful Soup
&lt;a href=&#34;http://www.foo.bar&#34;&gt;http://www.foo.bar&lt;/a&gt;
&lt;a href=&#34;http://www.foo.bar?q=&amp;quot;foo&amp;quot;&#34;&gt;http://www.foo.bar?q=&#34;foo&#34;&lt;/a&gt;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;a href=&#34;https://foo.bar&#34;&gt;https://foo.bar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Work &lt;a href=&#34;http://foo/&#34;&gt;like this&lt;/a&gt; and &lt;a href=&#34;ftp://bar&#34;&gt;like that&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://url.com
&lt;/code&gt;&lt;/pre&gt;&#34;&#34;&#34;
        html = to_html(text)
        self.assertEqual(html, expected)

    def test_latex_math(self):
        expected = r&#39;&#39;&#39;&lt;p&gt;Inline equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.latex_math)
        html = to_html(text, module=self._module, link=self._link, latex_math=True)
        self.assertEqual(html, expected)


@unittest.skipIf(&#39;win&#39; in sys.platform, &#34;signal.SIGALRM doesn&#39;t work on Windos&#34;)
class HttpTest(unittest.TestCase):
    &#34;&#34;&#34;
    Unit tests for the HTTP server functionality.
    &#34;&#34;&#34;
    @contextmanager
    def _timeout(self, secs):
        def _raise(*_):
            raise TimeoutError

        signal.signal(signal.SIGALRM, _raise)
        signal.alarm(secs)
        yield
        signal.alarm(0)

    @contextmanager
    def _http(self, modules: list):
        port = randint(9000, 12000)

        with self._timeout(1000):
            with redirect_streams() as (stdout, stderr):
                t = threading.Thread(
                    target=cli.main,
                    args=(cli.parser.parse_args([&#39;--http&#39;, &#39;:%d&#39; % port] + modules),))
                t.start()
                sleep(.1)

                if not t.is_alive():
                    sys.__stderr__.write(stderr.getvalue())
                    raise AssertionError

                try:
                    yield &#39;http://localhost:{}/&#39;.format(port)
                except Exception:
                    sys.__stderr__.write(stderr.getvalue())
                    sys.__stdout__.write(stdout.getvalue())
                    raise
                finally:
                    pdoc.cli._httpd.shutdown()  # type: ignore
                    t.join()

    def test_http(self):
        with self._http([&#39;pdoc&#39;, os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)]) as url:
            with self.subTest(url=&#39;/&#39;):
                with urlopen(url, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;Python package &lt;code&gt;pdoc&lt;/code&gt;&#39;, html)
                    self.assertNotIn(b&#39;gzip&#39;, html)
            with self.subTest(url=&#39;/&#39; + EXAMPLE_MODULE):
                with urlopen(url + &#39;pdoc&#39;, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;__pdoc__&#39;, html)
            with self.subTest(url=&#39;/csv.ext&#39;):
                with urlopen(url + &#39;csv.ext&#39;, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;DictReader&#39;, html)

    def test_file(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            with self._http([&#39;_relative_import&#39;]) as url:
                with urlopen(url, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;&lt;a href=&#34;/_relative_import&#34;&gt;&#39;, html)

    def test_head(self):
        with self._http([&#39;pdoc&#39;]) as url:
            with urlopen(Request(url + &#39;pdoc/&#39;,
                                 method=&#39;HEAD&#39;,
                                 headers={&#39;If-None-Match&#39;: &#39;xxx&#39;})) as resp:
                self.assertEqual(resp.status, 205)
            with self.assertRaises(HTTPError) as cm:
                urlopen(Request(url + &#39;pdoc/&#39;,
                                method=&#39;HEAD&#39;,
                                headers={&#39;If-None-Match&#39;: str(os.stat(pdoc.__file__).st_mtime)}))
            self.assertEqual(cm.exception.code, 304)


if __name__ == &#39;__main__&#39;:
    unittest.main()</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="pdoc.test.example_pkg" href="example_pkg/index.html">pdoc.test.example_pkg</a></code></dt>
<dd>
<div class="desc"><p>Module docstring</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pdoc.test.chdir"><code class="name flex">
<span>def <span class="ident">chdir</span></span>(<span>path)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L46-L53" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@contextmanager
def chdir(path):
    old = os.getcwd()
    try:
        os.chdir(path)
        yield
    finally:
        os.chdir(old)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ignore_warnings"><code class="name flex">
<span>def <span class="ident">ignore_warnings</span></span>(<span>func)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L83-L89" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def ignore_warnings(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        with warnings.catch_warnings():
            warnings.simplefilter(&#39;ignore&#39;)
            func(*args, **kwargs)
    return wrapper</code></pre>
</details>
</dd>
<dt id="pdoc.test.redirect_streams"><code class="name flex">
<span>def <span class="ident">redirect_streams</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L76-L80" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@contextmanager
def redirect_streams():
    stdout, stderr = StringIO(), StringIO()
    with redirect_stderr(stderr), redirect_stdout(stdout):
        yield stdout, stderr</code></pre>
</details>
</dd>
<dt id="pdoc.test.run"><code class="name flex">
<span>def <span class="ident">run</span></span>(<span>*args, **kwargs) -> int</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L56-L65" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def run(*args, _check=True, **kwargs) -&gt; int:
    params = ((&#39;--&#39; + key.replace(&#39;_&#39;, &#39;-&#39;), value)
              for key, value in kwargs.items())
    params = list(filter(None, chain.from_iterable(params)))  # type: ignore
    _args = cli.parser.parse_args([*params, *args])           # type: ignore
    try:
        returncode = cli.main(_args)
        return returncode or 0
    except SystemExit as e:
        return e.code</code></pre>
</details>
</dd>
<dt id="pdoc.test.run_html"><code class="name flex">
<span>def <span class="ident">run_html</span></span>(<span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L68-L73" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@contextmanager
def run_html(*args, **kwargs):
    with temp_dir() as path:
        run(*args, html=None, output_dir=path, **kwargs)
        with chdir(path):
            yield</code></pre>
</details>
</dd>
<dt id="pdoc.test.temp_dir"><code class="name flex">
<span>def <span class="ident">temp_dir</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L40-L43" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@contextmanager
def temp_dir():
    with TemporaryDirectory(prefix=&#39;pdoc-test-&#39;) as path:
        yield path</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pdoc.test.ApiTest"><code class="flex name class">
<span>class <span class="ident">ApiTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>Programmatic/API unit tests.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L386-L921" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ApiTest(unittest.TestCase):
    &#34;&#34;&#34;
    Programmatic/API unit tests.
    &#34;&#34;&#34;

    def setUp(self):
        pdoc.reset()

    def test_module(self):
        modules = {
            EXAMPLE_MODULE: (&#39;&#39;, (&#39;index&#39;, &#39;module&#39;, &#39;subpkg&#39;, &#39;subpkg2&#39;)),
            EXAMPLE_MODULE + &#39;.subpkg2&#39;: (&#39;.subpkg2&#39;, (&#39;subpkg2.module&#39;,)),
        }
        with chdir(TESTS_BASEDIR):
            for module, (name_suffix, submodules) in modules.items():
                with self.subTest(module=module):
                    m = pdoc.Module(module)
                    self.assertEqual(repr(m), &#34;&lt;Module &#39;{}&#39;&gt;&#34;.format(m.obj.__name__))
                    self.assertEqual(m.name, EXAMPLE_MODULE + name_suffix)
                    self.assertEqual(sorted(m.name for m in m.submodules()),
                                     [EXAMPLE_MODULE + &#39;.&#39; + m for m in submodules])

    def test_Module_find_class(self):
        class A:
            __module__ = None

        assert A.__module__ is None
        mod = pdoc.Module(pdoc)
        self.assertIsInstance(mod.find_class(pdoc.Doc), pdoc.Class)
        self.assertIsInstance(mod.find_class(A), pdoc.External)

    def test_import_filename(self):
        with patch.object(sys, &#39;path&#39;, [&#39;&#39;]), \
                chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            pdoc.import_module(&#39;index&#39;)

    def test_imported_once(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            pdoc.import_module(&#39;_imported_once.py&#39;)

    def test_namespace(self):
        # Test the three namespace types
        # https://packaging.python.org/guides/packaging-namespace-packages/#creating-a-namespace-package
        for i in range(1, 4):
            path = os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_namespace&#39;, str(i))
            with patch.object(sys, &#39;path&#39;, [os.path.join(path, &#39;a&#39;),
                                            os.path.join(path, &#39;b&#39;)]):
                mod = pdoc.Module(&#39;a.main&#39;)
                self.assertIn(&#39;D&#39;, mod.doc)

    def test_module_allsubmodules(self):
        m = pdoc.Module(EXAMPLE_MODULE + &#39;._private&#39;)
        self.assertEqual(sorted(m.name for m in m.submodules()),
                         [EXAMPLE_MODULE + &#39;._private.module&#39;])

    def test_instance_var(self):
        pdoc.reset()
        mod = pdoc.Module(EXAMPLE_MODULE)
        var = mod.doc[&#39;B&#39;].doc[&#39;instance_var&#39;]
        self.assertTrue(var.instance_var)

    def test_readonly_value_descriptors(self):
        pdoc.reset()
        mod = pdoc.Module(pdoc.import_module(EXAMPLE_MODULE))
        var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor&#39;]
        self.assertIsInstance(var, pdoc.Variable)
        self.assertTrue(var.instance_var)
        self.assertEqual(var.docstring, &#34;&#34;&#34;ro_value_descriptor docstring&#34;&#34;&#34;)
        self.assertTrue(var.source)

        var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor_no_doc&#39;]
        self.assertIsInstance(var, pdoc.Variable)
        self.assertTrue(var.instance_var)
        self.assertEqual(var.docstring, &#34;&#34;&#34;Read-only value descriptor&#34;&#34;&#34;)
        self.assertTrue(var.source)

    def test_class_variables_docstring_not_from_obj(self):
        class C:
            vars_dont = 0
            but_clss_have_doc = int

        with self.assertWarns(UserWarning):
            doc = pdoc.Class(&#39;C&#39;, pdoc.Module(&#39;pdoc&#39;), C)
        self.assertEqual(doc.doc[&#39;vars_dont&#39;].docstring, &#39;&#39;)
        self.assertIn(&#39;integer&#39;, doc.doc[&#39;but_clss_have_doc&#39;].docstring)

    def test_builtin_methoddescriptors(self):
        import parser
        with self.assertWarns(UserWarning):
            c = pdoc.Class(&#39;STType&#39;, pdoc.Module(parser), parser.STType)
        self.assertIsInstance(c.doc[&#39;compile&#39;], pdoc.Function)

    def test_refname(self):
        mod = EXAMPLE_MODULE + &#39;.&#39; + &#39;subpkg&#39;
        module = pdoc.Module(mod)
        var = module.doc[&#39;var&#39;]
        cls = module.doc[&#39;B&#39;]
        nested_cls = cls.doc[&#39;C&#39;]
        cls_var = cls.doc[&#39;var&#39;]
        method = cls.doc[&#39;f&#39;]

        self.assertEqual(pdoc.External(&#39;foo&#39;).refname, &#39;foo&#39;)
        self.assertEqual(module.refname, mod)
        self.assertEqual(var.refname, mod + &#39;.var&#39;)
        self.assertEqual(cls.refname, mod + &#39;.B&#39;)
        self.assertEqual(nested_cls.refname, mod + &#39;.B.C&#39;)
        self.assertEqual(cls_var.refname, mod + &#39;.B.var&#39;)
        self.assertEqual(method.refname, mod + &#39;.B.f&#39;)

        # Inherited method&#39;s refname points to class&#39; implicit copy
        pdoc.link_inheritance()
        self.assertEqual(cls.doc[&#39;inherited&#39;].refname, mod + &#39;.B.inherited&#39;)

    def test_qualname(self):
        module = pdoc.Module(EXAMPLE_MODULE)
        var = module.doc[&#39;var&#39;]
        cls = module.doc[&#39;B&#39;]
        nested_cls = cls.doc[&#39;C&#39;]
        cls_var = cls.doc[&#39;var&#39;]
        method = cls.doc[&#39;f&#39;]

        self.assertEqual(pdoc.External(&#39;foo&#39;).qualname, &#39;foo&#39;)
        self.assertEqual(module.qualname, EXAMPLE_MODULE)
        self.assertEqual(var.qualname, &#39;var&#39;)
        self.assertEqual(cls.qualname, &#39;B&#39;)
        self.assertEqual(nested_cls.qualname, &#39;B.C&#39;)
        self.assertEqual(cls_var.qualname, &#39;B.var&#39;)
        self.assertEqual(method.qualname, &#39;B.f&#39;)

    def test__pdoc__dict(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A&#39;, mod.doc)
            self.assertNotIn(&#39;B&#39;, mod.doc)

        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.f&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;B&#39;, mod.doc)
            self.assertNotIn(&#39;f&#39;, mod.doc[&#39;B&#39;].doc)
            self.assertIsInstance(mod.find_ident(&#39;B.f&#39;), pdoc.External)

        # GH-125: https://github.com/pdoc3/pdoc/issues/125
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.inherited&#39;: False}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertNotIn(&#39;inherited&#39;, mod.doc[&#39;B&#39;].doc)

        # GH-99: https://github.com/pdoc3/pdoc/issues/99
        module = pdoc.import_module(EXAMPLE_MODULE + &#39;._exclude_dir&#39;)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;downloaded_modules&#39;: False}, create=True):
            mod = pdoc.Module(module)
            self.assertNotIn(&#39;downloaded_modules&#39;, mod.doc)

    def test__pdoc__invalid_value(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: 1}), \
                self.assertRaises(ValueError):
            pdoc.Module(module)
            pdoc.link_inheritance()

    def test__pdoc__whitelist(self):
        module = pdoc.import_module(EXAMPLE_MODULE)
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;A&#39;].doc)
        self.assertNotIn(&#39;_private_function&#39;, mod.doc)

        # Override docstring string
        docstring = &#34;Overwrite private function doc&#34;
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;A.__call__&#39;: docstring}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertEqual(mod.doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring, docstring)

        # Module-relative
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private_function&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;Private function&#39;, mod.doc[&#39;_private_function&#39;].docstring)
            self.assertNotIn(&#39;_private_function&#39;, mod.doc[&#34;subpkg&#34;].doc)

        # Defined in example_pkg, referring to a member of its submodule
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;subpkg.A.__call__&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

        # Using full refname
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg.subpkg.A.__call__&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

        # Entire module, absolute refname
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg._private&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;module&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

        # Entire module, relative
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;_private&#39;, mod.doc)
            self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
            self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

        # Private instance variables
        with patch.object(module, &#39;__pdoc__&#39;, {&#39;B._private_instance_var&#39;: True}):
            mod = pdoc.Module(module)
            pdoc.link_inheritance()
            self.assertIn(&#39;should be private&#39;, mod.doc[&#39;B&#39;].doc[&#39;_private_instance_var&#39;].docstring)

    def test__all__(self):
        module = pdoc.import_module(EXAMPLE_MODULE + &#39;.index&#39;)
        with patch.object(module, &#39;__all__&#39;, [&#39;B&#39;], create=True):
            mod = pdoc.Module(module)
            with self.assertWarns(UserWarning):  # Only B is used but __pdoc__ contains others
                pdoc.link_inheritance()
            self.assertEqual(list(mod.doc.keys()), [&#39;B&#39;])

    def test_find_ident(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.Module)
        mod = pdoc.Module(pdoc)
        self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.External)

        self.assertIsInstance(mod.find_ident(EXAMPLE_MODULE + &#39;.subpkg&#39;), pdoc.Module)

        nonexistent = &#39;foo()&#39;
        result = mod.find_ident(nonexistent)
        self.assertIsInstance(result, pdoc.External)
        self.assertEqual(result.name, nonexistent)

        # Ref by class __init__
        mod = pdoc.Module(pdoc)
        self.assertIs(mod.find_ident(&#39;pdoc.Doc.__init__&#39;).obj, pdoc.Doc)

    def test_inherits(self):
        module = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()

        a = module.doc[&#39;A&#39;]
        b = module.doc[&#39;B&#39;]
        self.assertEqual(b.doc[&#39;inherited&#39;].inherits,
                         a.doc[&#39;inherited&#39;])
        self.assertEqual(b.doc[&#39;overridden_same_docstring&#39;].inherits,
                         a.doc[&#39;overridden_same_docstring&#39;])
        self.assertEqual(b.doc[&#39;overridden&#39;].inherits,
                         None)

        c = module.doc[&#39;C&#39;]
        d = module.doc[&#39;D&#39;]
        self.assertEqual(d.doc[&#39;overridden&#39;].inherits, c.doc[&#39;overridden&#39;])
        self.assertEqual(c.doc[&#39;overridden&#39;].inherits, b.doc[&#39;overridden&#39;])

    def test_inherited_members(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()
        a = mod.doc[&#39;A&#39;]
        b = mod.doc[&#39;B&#39;]
        self.assertEqual(b.inherited_members(), [(a, [a.doc[&#39;inherited&#39;],
                                                      a.doc[&#39;overridden_same_docstring&#39;]])])
        self.assertEqual(a.inherited_members(), [])

    @ignore_warnings
    def test_subclasses(self):
        class A:
            pass

        class B(type):
            pass

        class C(A):
            pass

        class D(B):
            pass

        class G(C):
            pass

        class F(C):
            pass

        class E(C):
            pass

        mod = pdoc.Module(pdoc)
        self.assertEqual([x.refname for x in pdoc.Class(&#39;A&#39;, mod, A).subclasses()],
                         [mod.find_class(C).refname])
        self.assertEqual([x.refname for x in pdoc.Class(&#39;B&#39;, mod, B).subclasses()],
                         [mod.find_class(D).refname])
        self.assertEqual([x.refname for x in pdoc.Class(&#39;C&#39;, mod, C).subclasses()],
                         [mod.find_class(x).refname for x in (E, F, G)])

    def test_link_inheritance(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        with warnings.catch_warnings(record=True) as w:
            pdoc.link_inheritance()
            pdoc.link_inheritance()
        self.assertFalse(w)

        mod._is_inheritance_linked = False
        with self.assertWarns(UserWarning):
            pdoc.link_inheritance()

        # Test inheritance across modules
        pdoc.reset()
        mod = pdoc.Module(EXAMPLE_MODULE + &#39;._test_linking&#39;)
        pdoc.link_inheritance()
        a = mod.doc[&#39;a&#39;].doc[&#39;A&#39;]
        b = mod.doc[&#39;b&#39;].doc[&#39;B&#39;]
        c = mod.doc[&#39;b&#39;].doc[&#39;c&#39;].doc[&#39;C&#39;]
        self.assertEqual(b.doc[&#39;a&#39;].inherits, a.doc[&#39;a&#39;])
        self.assertEqual(b.doc[&#39;c&#39;].inherits, c.doc[&#39;c&#39;])
        # While classes do inherit from superclasses, they just shouldn&#39;t always
        # say so, because public classes do want to be exposed and linked to
        self.assertNotEqual(b.inherits, a)

    def test_context(self):
        context = {}
        pdoc.Module(pdoc, context=context)
        self.assertIn(&#39;pdoc&#39;, context)
        self.assertIn(&#39;pdoc.cli&#39;, context)
        self.assertIn(&#39;pdoc.cli.main&#39;, context)
        self.assertIn(&#39;pdoc.Module&#39;, context)
        self.assertIsInstance(context[&#39;pdoc&#39;], pdoc.Module)
        self.assertIsInstance(context[&#39;pdoc.cli&#39;], pdoc.Module)
        self.assertIsInstance(context[&#39;pdoc.cli.main&#39;], pdoc.Function)
        self.assertIsInstance(context[&#39;pdoc.Module&#39;], pdoc.Class)

        module = pdoc.Module(pdoc)
        self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.Class)
        pdoc.reset()
        self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.External)

    def test_Function_params(self):
        mod = pdoc.Module(pdoc)
        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, _a, _b=None: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;_a&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda _ok, a, _a, *args, _b=None, c=None, _d=None: None)
        self.assertEqual(func.params(), [&#39;_ok&#39;, &#39;a&#39;, &#39;_a&#39;, &#39;*args&#39;, &#39;c=None&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, b, *, _c=1: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;b&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a, *, b, c: None)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;*&#39;, &#39;b&#39;, &#39;c&#39;])

        func = pdoc.Function(&#39;f&#39;, mod,
                             lambda a=os.environ, b=sys.stdout: None)
        self.assertEqual(func.params(), [&#39;a=os.environ&#39;, &#39;b=sys.stdout&#39;])

        class Foo(enum.Enum):
            a, b = 1, 2
        func = pdoc.Function(&#39;f&#39;, mod, lambda a=Foo.a: None)
        self.assertEqual(func.params(), [&#39;a=Foo.a&#39;])

        func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
        self.assertEqual(func.params(), [&#39;a=&lt;object object&gt;&#39;])

        func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
        self.assertEqual(func.params(link=lambda x: &#39;&#39;), [&#39;a=&amp;lt;object object&amp;gt;&#39;])

        # typed
        def f(a: int, *b, c: typing.List[pdoc.Doc] = []): pass
        func = pdoc.Function(&#39;f&#39;, mod, f)
        self.assertEqual(func.params(), [&#39;a&#39;, &#39;*b&#39;, &#34;c=[]&#34;])
        self.assertEqual(func.params(annotate=True),
                         [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;, &#34;c:\N{NBSP}List[pdoc.Doc]\N{NBSP}=\N{NBSP}[]&#34;])

        # typed, linked
        def link(dobj):
            return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=mod), dobj.qualname)

        self.assertEqual(func.params(annotate=True, link=link),
                         [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;,
                          &#34;c:\N{NBSP}List[&lt;a href=\&#34;#pdoc.Doc\&#34;&gt;Doc&lt;/a&gt;]\N{NBSP}=\N{NBSP}[]&#34;])

        # shadowed name
        def f(pdoc: int): pass
        func = pdoc.Function(&#39;f&#39;, mod, f)
        self.assertEqual(func.params(annotate=True, link=link), [&#39;pdoc:\N{NBSP}int&#39;])

        def bug130_str_annotation(a: &#34;str&#34;):
            return

        self.assertEqual(pdoc.Function(&#39;bug130&#39;, mod, bug130_str_annotation).params(annotate=True),
                         [&#39;a:\N{NBSP}str&#39;])

        # builtin callables with signatures in docstrings
        from itertools import repeat
        self.assertEqual(pdoc.Function(&#39;repeat&#39;, mod, repeat).params(), [&#39;object&#39;, &#39;times&#39;])
        self.assertEqual(pdoc.Function(&#39;slice&#39;, mod, slice).params(), [&#39;start&#39;, &#39;stop&#39;, &#39;step&#39;])

        class get_sample(repeat):
            &#34;&#34;&#34; get_sample(self: pdoc.int, pos: int) -&gt; Tuple[int, float] &#34;&#34;&#34;
        self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).params(annotate=True),
                         [&#39;self:\xa0int&#39;, &#39;pos:\xa0int&#39;])
        self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).return_annotation(),
                         &#39;Tuple[int,\xa0float]&#39;)

    def test_Function_return_annotation(self):
        import typing

        def f() -&gt; typing.List[typing.Union[str, pdoc.Doc]]: pass
        func = pdoc.Function(&#39;f&#39;, pdoc.Module(pdoc), f)
        self.assertEqual(func.return_annotation(), &#39;List[Union[str,\N{NBSP}pdoc.Doc]]&#39;)

    @ignore_warnings
    def test_Variable_type_annotation(self):
        import typing

        class Foobar:
            @property
            def prop(self) -&gt; typing.Optional[int]:
                pass

        mod = pdoc.Module(pdoc)
        cls = pdoc.Class(&#39;Foobar&#39;, mod, Foobar)
        self.assertEqual(cls.doc[&#39;prop&#39;].type_annotation(), &#39;Union[int,\N{NBSP}NoneType]&#39;)

    @ignore_warnings
    @unittest.skipIf(sys.version_info &lt; (3, 6), &#39;variable annotation unsupported in &lt;Py3.6&#39;)
    def test_Variable_type_annotation_py35plus(self):
        exec(&#39;&#39;&#39;class Foo:
                    var: int = 3
                    &#34;&#34;&#34;var&#34;&#34;&#34;
        &#39;&#39;&#39;)
        mod = pdoc.Module(pdoc)
        cls = pdoc.Class(&#39;Foobar&#39;, mod, locals()[&#39;Foo&#39;])
        self.assertEqual(cls.doc[&#39;var&#39;].type_annotation(), &#39;int&#39;)

    @ignore_warnings
    def test_Class_docstring(self):
        class A:
            &#34;&#34;&#34;foo&#34;&#34;&#34;

        class B:
            def __init__(self):
                &#34;&#34;&#34;foo&#34;&#34;&#34;

        class C:
            &#34;&#34;&#34;foo&#34;&#34;&#34;

            def __init__(self):
                &#34;&#34;&#34;bar&#34;&#34;&#34;

        class D(C):
            &#34;&#34;&#34;baz&#34;&#34;&#34;

        class E(C):
            def __init__(self):
                &#34;&#34;&#34;baz&#34;&#34;&#34;

        mod = pdoc.Module(pdoc)
        self.assertEqual(pdoc.Class(&#39;A&#39;, mod, A).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;B&#39;, mod, B).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).docstring, &#34;&#34;&#34;foo\n\nbar&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;D&#39;, mod, D).docstring, &#34;&#34;&#34;baz\n\nbar&#34;&#34;&#34;)
        self.assertEqual(pdoc.Class(&#39;E&#39;, mod, E).docstring, &#34;&#34;&#34;foo\n\nbaz&#34;&#34;&#34;)

    @ignore_warnings
    def test_Class_params(self):
        class C:
            def __init__(self, x):
                pass

        mod = pdoc.Module(pdoc)
        self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [&#39;x&#39;])
        with patch.dict(mod.obj.__pdoc__, {&#39;C.__init__&#39;: False}):
            self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [])

        # test case for https://github.com/pdoc3/pdoc/issues/124
        class C2:
            __signature__ = inspect.signature(lambda a, b, c=None, *, d=1, e: None)

        self.assertEqual(pdoc.Class(&#39;C2&#39;, mod, C2).params(), [&#39;a&#39;, &#39;b&#39;, &#39;c=None&#39;, &#39;*&#39;, &#39;d=1&#39;, &#39;e&#39;])

    def test_url(self):
        mod = pdoc.Module(EXAMPLE_MODULE)
        pdoc.link_inheritance()

        c = mod.doc[&#39;D&#39;]
        self.assertEqual(c.url(), &#39;example_pkg/index.html#example_pkg.D&#39;)
        self.assertEqual(c.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D&#39;)
        self.assertEqual(c.url(relative_to=c.module), &#39;#example_pkg.D&#39;)
        self.assertEqual(c.url(top_ancestor=True), c.url())  # Public classes do link to themselves

        f = c.doc[&#39;overridden&#39;]
        self.assertEqual(f.url(), &#39;example_pkg/index.html#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(relative_to=c.module), &#39;#example_pkg.D.overridden&#39;)
        self.assertEqual(f.url(top_ancestor=1), &#39;example_pkg/index.html#example_pkg.B.overridden&#39;)

    @unittest.skipIf(sys.version_info &lt; (3, 6), reason=&#34;only deterministic on CPython 3.6+&#34;)
    def test_sorting(self):
        module = pdoc.Module(EXAMPLE_MODULE)

        sorted_variables = module.variables()
        unsorted_variables = module.variables(sort=False)
        self.assertNotEqual(sorted_variables, unsorted_variables)
        self.assertEqual(sorted_variables, sorted(unsorted_variables))

        sorted_functions = module.functions()
        unsorted_functions = module.functions(sort=False)
        self.assertNotEqual(sorted_functions, unsorted_functions)
        self.assertEqual(sorted_functions, sorted(unsorted_functions))

        sorted_classes = module.classes()
        unsorted_classes = module.classes(sort=False)
        self.assertNotEqual(sorted_classes, unsorted_classes)
        self.assertEqual(sorted_classes, sorted(unsorted_classes))

        cls = module.doc[&#34;Docformats&#34;]

        sorted_methods = cls.methods()
        unsorted_methods = cls.methods(sort=False)
        self.assertNotEqual(sorted_methods, unsorted_methods)
        self.assertEqual(sorted_methods, sorted(unsorted_methods))

    def test_module_init(self):
        mod = pdoc.Module(&#39;pdoc.__init__&#39;)
        self.assertEqual(mod.name, &#39;pdoc&#39;)
        self.assertIn(&#39;Module&#39;, mod.doc)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pdoc.test.ApiTest.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L391-L392" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def setUp(self):
    pdoc.reset()</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Class_docstring"><code class="name flex">
<span>def <span class="ident">test_Class_docstring</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L830-L857" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@ignore_warnings
def test_Class_docstring(self):
    class A:
        &#34;&#34;&#34;foo&#34;&#34;&#34;

    class B:
        def __init__(self):
            &#34;&#34;&#34;foo&#34;&#34;&#34;

    class C:
        &#34;&#34;&#34;foo&#34;&#34;&#34;

        def __init__(self):
            &#34;&#34;&#34;bar&#34;&#34;&#34;

    class D(C):
        &#34;&#34;&#34;baz&#34;&#34;&#34;

    class E(C):
        def __init__(self):
            &#34;&#34;&#34;baz&#34;&#34;&#34;

    mod = pdoc.Module(pdoc)
    self.assertEqual(pdoc.Class(&#39;A&#39;, mod, A).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
    self.assertEqual(pdoc.Class(&#39;B&#39;, mod, B).docstring, &#34;&#34;&#34;foo&#34;&#34;&#34;)
    self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).docstring, &#34;&#34;&#34;foo\n\nbar&#34;&#34;&#34;)
    self.assertEqual(pdoc.Class(&#39;D&#39;, mod, D).docstring, &#34;&#34;&#34;baz\n\nbar&#34;&#34;&#34;)
    self.assertEqual(pdoc.Class(&#39;E&#39;, mod, E).docstring, &#34;&#34;&#34;foo\n\nbaz&#34;&#34;&#34;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Class_params"><code class="name flex">
<span>def <span class="ident">test_Class_params</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L859-L874" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@ignore_warnings
def test_Class_params(self):
    class C:
        def __init__(self, x):
            pass

    mod = pdoc.Module(pdoc)
    self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [&#39;x&#39;])
    with patch.dict(mod.obj.__pdoc__, {&#39;C.__init__&#39;: False}):
        self.assertEqual(pdoc.Class(&#39;C&#39;, mod, C).params(), [])

    # test case for https://github.com/pdoc3/pdoc/issues/124
    class C2:
        __signature__ = inspect.signature(lambda a, b, c=None, *, d=1, e: None)

    self.assertEqual(pdoc.Class(&#39;C2&#39;, mod, C2).params(), [&#39;a&#39;, &#39;b&#39;, &#39;c=None&#39;, &#39;*&#39;, &#39;d=1&#39;, &#39;e&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Function_params"><code class="name flex">
<span>def <span class="ident">test_Function_params</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L728-L797" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_Function_params(self):
    mod = pdoc.Module(pdoc)
    func = pdoc.Function(&#39;f&#39;, mod,
                         lambda a, _a, _b=None: None)
    self.assertEqual(func.params(), [&#39;a&#39;, &#39;_a&#39;])

    func = pdoc.Function(&#39;f&#39;, mod,
                         lambda _ok, a, _a, *args, _b=None, c=None, _d=None: None)
    self.assertEqual(func.params(), [&#39;_ok&#39;, &#39;a&#39;, &#39;_a&#39;, &#39;*args&#39;, &#39;c=None&#39;])

    func = pdoc.Function(&#39;f&#39;, mod,
                         lambda a, b, *, _c=1: None)
    self.assertEqual(func.params(), [&#39;a&#39;, &#39;b&#39;])

    func = pdoc.Function(&#39;f&#39;, mod,
                         lambda a, *, b, c: None)
    self.assertEqual(func.params(), [&#39;a&#39;, &#39;*&#39;, &#39;b&#39;, &#39;c&#39;])

    func = pdoc.Function(&#39;f&#39;, mod,
                         lambda a=os.environ, b=sys.stdout: None)
    self.assertEqual(func.params(), [&#39;a=os.environ&#39;, &#39;b=sys.stdout&#39;])

    class Foo(enum.Enum):
        a, b = 1, 2
    func = pdoc.Function(&#39;f&#39;, mod, lambda a=Foo.a: None)
    self.assertEqual(func.params(), [&#39;a=Foo.a&#39;])

    func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
    self.assertEqual(func.params(), [&#39;a=&lt;object object&gt;&#39;])

    func = pdoc.Function(&#39;f&#39;, mod, lambda a=object(): None)
    self.assertEqual(func.params(link=lambda x: &#39;&#39;), [&#39;a=&amp;lt;object object&amp;gt;&#39;])

    # typed
    def f(a: int, *b, c: typing.List[pdoc.Doc] = []): pass
    func = pdoc.Function(&#39;f&#39;, mod, f)
    self.assertEqual(func.params(), [&#39;a&#39;, &#39;*b&#39;, &#34;c=[]&#34;])
    self.assertEqual(func.params(annotate=True),
                     [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;, &#34;c:\N{NBSP}List[pdoc.Doc]\N{NBSP}=\N{NBSP}[]&#34;])

    # typed, linked
    def link(dobj):
        return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=mod), dobj.qualname)

    self.assertEqual(func.params(annotate=True, link=link),
                     [&#39;a:\N{NBSP}int&#39;, &#39;*b&#39;,
                      &#34;c:\N{NBSP}List[&lt;a href=\&#34;#pdoc.Doc\&#34;&gt;Doc&lt;/a&gt;]\N{NBSP}=\N{NBSP}[]&#34;])

    # shadowed name
    def f(pdoc: int): pass
    func = pdoc.Function(&#39;f&#39;, mod, f)
    self.assertEqual(func.params(annotate=True, link=link), [&#39;pdoc:\N{NBSP}int&#39;])

    def bug130_str_annotation(a: &#34;str&#34;):
        return

    self.assertEqual(pdoc.Function(&#39;bug130&#39;, mod, bug130_str_annotation).params(annotate=True),
                     [&#39;a:\N{NBSP}str&#39;])

    # builtin callables with signatures in docstrings
    from itertools import repeat
    self.assertEqual(pdoc.Function(&#39;repeat&#39;, mod, repeat).params(), [&#39;object&#39;, &#39;times&#39;])
    self.assertEqual(pdoc.Function(&#39;slice&#39;, mod, slice).params(), [&#39;start&#39;, &#39;stop&#39;, &#39;step&#39;])

    class get_sample(repeat):
        &#34;&#34;&#34; get_sample(self: pdoc.int, pos: int) -&gt; Tuple[int, float] &#34;&#34;&#34;
    self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).params(annotate=True),
                     [&#39;self:\xa0int&#39;, &#39;pos:\xa0int&#39;])
    self.assertEqual(pdoc.Function(&#39;get_sample&#39;, mod, get_sample).return_annotation(),
                     &#39;Tuple[int,\xa0float]&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Function_return_annotation"><code class="name flex">
<span>def <span class="ident">test_Function_return_annotation</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L799-L804" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_Function_return_annotation(self):
    import typing

    def f() -&gt; typing.List[typing.Union[str, pdoc.Doc]]: pass
    func = pdoc.Function(&#39;f&#39;, pdoc.Module(pdoc), f)
    self.assertEqual(func.return_annotation(), &#39;List[Union[str,\N{NBSP}pdoc.Doc]]&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Module_find_class"><code class="name flex">
<span>def <span class="ident">test_Module_find_class</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L408-L415" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_Module_find_class(self):
    class A:
        __module__ = None

    assert A.__module__ is None
    mod = pdoc.Module(pdoc)
    self.assertIsInstance(mod.find_class(pdoc.Doc), pdoc.Class)
    self.assertIsInstance(mod.find_class(A), pdoc.External)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Variable_type_annotation"><code class="name flex">
<span>def <span class="ident">test_Variable_type_annotation</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L806-L817" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@ignore_warnings
def test_Variable_type_annotation(self):
    import typing

    class Foobar:
        @property
        def prop(self) -&gt; typing.Optional[int]:
            pass

    mod = pdoc.Module(pdoc)
    cls = pdoc.Class(&#39;Foobar&#39;, mod, Foobar)
    self.assertEqual(cls.doc[&#39;prop&#39;].type_annotation(), &#39;Union[int,\N{NBSP}NoneType]&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_Variable_type_annotation_py35plus"><code class="name flex">
<span>def <span class="ident">test_Variable_type_annotation_py35plus</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L819-L828" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@ignore_warnings
@unittest.skipIf(sys.version_info &lt; (3, 6), &#39;variable annotation unsupported in &lt;Py3.6&#39;)
def test_Variable_type_annotation_py35plus(self):
    exec(&#39;&#39;&#39;class Foo:
                var: int = 3
                &#34;&#34;&#34;var&#34;&#34;&#34;
    &#39;&#39;&#39;)
    mod = pdoc.Module(pdoc)
    cls = pdoc.Class(&#39;Foobar&#39;, mod, locals()[&#39;Foo&#39;])
    self.assertEqual(cls.doc[&#39;var&#39;].type_annotation(), &#39;int&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test__all__"><code class="name flex">
<span>def <span class="ident">test__all__</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L604-L610" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test__all__(self):
    module = pdoc.import_module(EXAMPLE_MODULE + &#39;.index&#39;)
    with patch.object(module, &#39;__all__&#39;, [&#39;B&#39;], create=True):
        mod = pdoc.Module(module)
        with self.assertWarns(UserWarning):  # Only B is used but __pdoc__ contains others
            pdoc.link_inheritance()
        self.assertEqual(list(mod.doc.keys()), [&#39;B&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test__pdoc__dict"><code class="name flex">
<span>def <span class="ident">test__pdoc__dict</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L515-L540" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test__pdoc__dict(self):
    module = pdoc.import_module(EXAMPLE_MODULE)
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: False}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;A&#39;, mod.doc)
        self.assertNotIn(&#39;B&#39;, mod.doc)

    with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.f&#39;: False}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;B&#39;, mod.doc)
        self.assertNotIn(&#39;f&#39;, mod.doc[&#39;B&#39;].doc)
        self.assertIsInstance(mod.find_ident(&#39;B.f&#39;), pdoc.External)

    # GH-125: https://github.com/pdoc3/pdoc/issues/125
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;B.inherited&#39;: False}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertNotIn(&#39;inherited&#39;, mod.doc[&#39;B&#39;].doc)

    # GH-99: https://github.com/pdoc3/pdoc/issues/99
    module = pdoc.import_module(EXAMPLE_MODULE + &#39;._exclude_dir&#39;)
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;downloaded_modules&#39;: False}, create=True):
        mod = pdoc.Module(module)
        self.assertNotIn(&#39;downloaded_modules&#39;, mod.doc)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test__pdoc__invalid_value"><code class="name flex">
<span>def <span class="ident">test__pdoc__invalid_value</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L542-L547" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test__pdoc__invalid_value(self):
    module = pdoc.import_module(EXAMPLE_MODULE)
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;B&#39;: 1}), \
            self.assertRaises(ValueError):
        pdoc.Module(module)
        pdoc.link_inheritance()</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test__pdoc__whitelist"><code class="name flex">
<span>def <span class="ident">test__pdoc__whitelist</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L549-L602" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test__pdoc__whitelist(self):
    module = pdoc.import_module(EXAMPLE_MODULE)
    mod = pdoc.Module(module)
    pdoc.link_inheritance()
    self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;A&#39;].doc)
    self.assertNotIn(&#39;_private_function&#39;, mod.doc)

    # Override docstring string
    docstring = &#34;Overwrite private function doc&#34;
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;A.__call__&#39;: docstring}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertEqual(mod.doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring, docstring)

    # Module-relative
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private_function&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;Private function&#39;, mod.doc[&#39;_private_function&#39;].docstring)
        self.assertNotIn(&#39;_private_function&#39;, mod.doc[&#34;subpkg&#34;].doc)

    # Defined in example_pkg, referring to a member of its submodule
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;subpkg.A.__call__&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

    # Using full refname
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg.subpkg.A.__call__&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;A.__call__&#39;, mod.doc[&#39;subpkg&#39;].doc[&#39;A&#39;].doc[&#39;__call__&#39;].docstring)

    # Entire module, absolute refname
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;example_pkg._private&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;module&#39;, mod.doc[&#39;_private&#39;].doc)
        self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
        self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

    # Entire module, relative
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;_private&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;_private&#39;, mod.doc)
        self.assertNotIn(&#39;_private&#39;, mod.doc[&#39;_private&#39;].doc)
        self.assertNotIn(&#39;__call__&#39;, mod.doc[&#39;_private&#39;].doc[&#39;module&#39;].doc)

    # Private instance variables
    with patch.object(module, &#39;__pdoc__&#39;, {&#39;B._private_instance_var&#39;: True}):
        mod = pdoc.Module(module)
        pdoc.link_inheritance()
        self.assertIn(&#39;should be private&#39;, mod.doc[&#39;B&#39;].doc[&#39;_private_instance_var&#39;].docstring)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_builtin_methoddescriptors"><code class="name flex">
<span>def <span class="ident">test_builtin_methoddescriptors</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L472-L476" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_builtin_methoddescriptors(self):
    import parser
    with self.assertWarns(UserWarning):
        c = pdoc.Class(&#39;STType&#39;, pdoc.Module(parser), parser.STType)
    self.assertIsInstance(c.doc[&#39;compile&#39;], pdoc.Function)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_class_variables_docstring_not_from_obj"><code class="name flex">
<span>def <span class="ident">test_class_variables_docstring_not_from_obj</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L462-L470" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_class_variables_docstring_not_from_obj(self):
    class C:
        vars_dont = 0
        but_clss_have_doc = int

    with self.assertWarns(UserWarning):
        doc = pdoc.Class(&#39;C&#39;, pdoc.Module(&#39;pdoc&#39;), C)
    self.assertEqual(doc.doc[&#39;vars_dont&#39;].docstring, &#39;&#39;)
    self.assertIn(&#39;integer&#39;, doc.doc[&#39;but_clss_have_doc&#39;].docstring)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_context"><code class="name flex">
<span>def <span class="ident">test_context</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L711-L726" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_context(self):
    context = {}
    pdoc.Module(pdoc, context=context)
    self.assertIn(&#39;pdoc&#39;, context)
    self.assertIn(&#39;pdoc.cli&#39;, context)
    self.assertIn(&#39;pdoc.cli.main&#39;, context)
    self.assertIn(&#39;pdoc.Module&#39;, context)
    self.assertIsInstance(context[&#39;pdoc&#39;], pdoc.Module)
    self.assertIsInstance(context[&#39;pdoc.cli&#39;], pdoc.Module)
    self.assertIsInstance(context[&#39;pdoc.cli.main&#39;], pdoc.Function)
    self.assertIsInstance(context[&#39;pdoc.Module&#39;], pdoc.Class)

    module = pdoc.Module(pdoc)
    self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.Class)
    pdoc.reset()
    self.assertIsInstance(module.find_ident(&#39;pdoc.Module&#39;), pdoc.External)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_find_ident"><code class="name flex">
<span>def <span class="ident">test_find_ident</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L612-L627" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_find_ident(self):
    mod = pdoc.Module(EXAMPLE_MODULE)
    self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.Module)
    mod = pdoc.Module(pdoc)
    self.assertIsInstance(mod.find_ident(&#39;subpkg&#39;), pdoc.External)

    self.assertIsInstance(mod.find_ident(EXAMPLE_MODULE + &#39;.subpkg&#39;), pdoc.Module)

    nonexistent = &#39;foo()&#39;
    result = mod.find_ident(nonexistent)
    self.assertIsInstance(result, pdoc.External)
    self.assertEqual(result.name, nonexistent)

    # Ref by class __init__
    mod = pdoc.Module(pdoc)
    self.assertIs(mod.find_ident(&#39;pdoc.Doc.__init__&#39;).obj, pdoc.Doc)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_import_filename"><code class="name flex">
<span>def <span class="ident">test_import_filename</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L417-L420" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_import_filename(self):
    with patch.object(sys, &#39;path&#39;, [&#39;&#39;]), \
            chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
        pdoc.import_module(&#39;index&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_imported_once"><code class="name flex">
<span>def <span class="ident">test_imported_once</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L422-L424" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_imported_once(self):
    with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
        pdoc.import_module(&#39;_imported_once.py&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_inherited_members"><code class="name flex">
<span>def <span class="ident">test_inherited_members</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L647-L654" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_inherited_members(self):
    mod = pdoc.Module(EXAMPLE_MODULE)
    pdoc.link_inheritance()
    a = mod.doc[&#39;A&#39;]
    b = mod.doc[&#39;B&#39;]
    self.assertEqual(b.inherited_members(), [(a, [a.doc[&#39;inherited&#39;],
                                                  a.doc[&#39;overridden_same_docstring&#39;]])])
    self.assertEqual(a.inherited_members(), [])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_inherits"><code class="name flex">
<span>def <span class="ident">test_inherits</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L629-L645" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_inherits(self):
    module = pdoc.Module(EXAMPLE_MODULE)
    pdoc.link_inheritance()

    a = module.doc[&#39;A&#39;]
    b = module.doc[&#39;B&#39;]
    self.assertEqual(b.doc[&#39;inherited&#39;].inherits,
                     a.doc[&#39;inherited&#39;])
    self.assertEqual(b.doc[&#39;overridden_same_docstring&#39;].inherits,
                     a.doc[&#39;overridden_same_docstring&#39;])
    self.assertEqual(b.doc[&#39;overridden&#39;].inherits,
                     None)

    c = module.doc[&#39;C&#39;]
    d = module.doc[&#39;D&#39;]
    self.assertEqual(d.doc[&#39;overridden&#39;].inherits, c.doc[&#39;overridden&#39;])
    self.assertEqual(c.doc[&#39;overridden&#39;].inherits, b.doc[&#39;overridden&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_instance_var"><code class="name flex">
<span>def <span class="ident">test_instance_var</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L441-L445" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_instance_var(self):
    pdoc.reset()
    mod = pdoc.Module(EXAMPLE_MODULE)
    var = mod.doc[&#39;B&#39;].doc[&#39;instance_var&#39;]
    self.assertTrue(var.instance_var)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_link_inheritance"><code class="name flex">
<span>def <span class="ident">test_link_inheritance</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L687-L709" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_link_inheritance(self):
    mod = pdoc.Module(EXAMPLE_MODULE)
    with warnings.catch_warnings(record=True) as w:
        pdoc.link_inheritance()
        pdoc.link_inheritance()
    self.assertFalse(w)

    mod._is_inheritance_linked = False
    with self.assertWarns(UserWarning):
        pdoc.link_inheritance()

    # Test inheritance across modules
    pdoc.reset()
    mod = pdoc.Module(EXAMPLE_MODULE + &#39;._test_linking&#39;)
    pdoc.link_inheritance()
    a = mod.doc[&#39;a&#39;].doc[&#39;A&#39;]
    b = mod.doc[&#39;b&#39;].doc[&#39;B&#39;]
    c = mod.doc[&#39;b&#39;].doc[&#39;c&#39;].doc[&#39;C&#39;]
    self.assertEqual(b.doc[&#39;a&#39;].inherits, a.doc[&#39;a&#39;])
    self.assertEqual(b.doc[&#39;c&#39;].inherits, c.doc[&#39;c&#39;])
    # While classes do inherit from superclasses, they just shouldn&#39;t always
    # say so, because public classes do want to be exposed and linked to
    self.assertNotEqual(b.inherits, a)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_module"><code class="name flex">
<span>def <span class="ident">test_module</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L394-L406" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_module(self):
    modules = {
        EXAMPLE_MODULE: (&#39;&#39;, (&#39;index&#39;, &#39;module&#39;, &#39;subpkg&#39;, &#39;subpkg2&#39;)),
        EXAMPLE_MODULE + &#39;.subpkg2&#39;: (&#39;.subpkg2&#39;, (&#39;subpkg2.module&#39;,)),
    }
    with chdir(TESTS_BASEDIR):
        for module, (name_suffix, submodules) in modules.items():
            with self.subTest(module=module):
                m = pdoc.Module(module)
                self.assertEqual(repr(m), &#34;&lt;Module &#39;{}&#39;&gt;&#34;.format(m.obj.__name__))
                self.assertEqual(m.name, EXAMPLE_MODULE + name_suffix)
                self.assertEqual(sorted(m.name for m in m.submodules()),
                                 [EXAMPLE_MODULE + &#39;.&#39; + m for m in submodules])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_module_allsubmodules"><code class="name flex">
<span>def <span class="ident">test_module_allsubmodules</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L436-L439" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_module_allsubmodules(self):
    m = pdoc.Module(EXAMPLE_MODULE + &#39;._private&#39;)
    self.assertEqual(sorted(m.name for m in m.submodules()),
                     [EXAMPLE_MODULE + &#39;._private.module&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_module_init"><code class="name flex">
<span>def <span class="ident">test_module_init</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L918-L921" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_module_init(self):
    mod = pdoc.Module(&#39;pdoc.__init__&#39;)
    self.assertEqual(mod.name, &#39;pdoc&#39;)
    self.assertIn(&#39;Module&#39;, mod.doc)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_namespace"><code class="name flex">
<span>def <span class="ident">test_namespace</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L426-L434" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_namespace(self):
    # Test the three namespace types
    # https://packaging.python.org/guides/packaging-namespace-packages/#creating-a-namespace-package
    for i in range(1, 4):
        path = os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_namespace&#39;, str(i))
        with patch.object(sys, &#39;path&#39;, [os.path.join(path, &#39;a&#39;),
                                        os.path.join(path, &#39;b&#39;)]):
            mod = pdoc.Module(&#39;a.main&#39;)
            self.assertIn(&#39;D&#39;, mod.doc)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_qualname"><code class="name flex">
<span>def <span class="ident">test_qualname</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L499-L513" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_qualname(self):
    module = pdoc.Module(EXAMPLE_MODULE)
    var = module.doc[&#39;var&#39;]
    cls = module.doc[&#39;B&#39;]
    nested_cls = cls.doc[&#39;C&#39;]
    cls_var = cls.doc[&#39;var&#39;]
    method = cls.doc[&#39;f&#39;]

    self.assertEqual(pdoc.External(&#39;foo&#39;).qualname, &#39;foo&#39;)
    self.assertEqual(module.qualname, EXAMPLE_MODULE)
    self.assertEqual(var.qualname, &#39;var&#39;)
    self.assertEqual(cls.qualname, &#39;B&#39;)
    self.assertEqual(nested_cls.qualname, &#39;B.C&#39;)
    self.assertEqual(cls_var.qualname, &#39;B.var&#39;)
    self.assertEqual(method.qualname, &#39;B.f&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_readonly_value_descriptors"><code class="name flex">
<span>def <span class="ident">test_readonly_value_descriptors</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L447-L460" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_readonly_value_descriptors(self):
    pdoc.reset()
    mod = pdoc.Module(pdoc.import_module(EXAMPLE_MODULE))
    var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor&#39;]
    self.assertIsInstance(var, pdoc.Variable)
    self.assertTrue(var.instance_var)
    self.assertEqual(var.docstring, &#34;&#34;&#34;ro_value_descriptor docstring&#34;&#34;&#34;)
    self.assertTrue(var.source)

    var = mod.doc[&#39;B&#39;].doc[&#39;ro_value_descriptor_no_doc&#39;]
    self.assertIsInstance(var, pdoc.Variable)
    self.assertTrue(var.instance_var)
    self.assertEqual(var.docstring, &#34;&#34;&#34;Read-only value descriptor&#34;&#34;&#34;)
    self.assertTrue(var.source)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_refname"><code class="name flex">
<span>def <span class="ident">test_refname</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L478-L497" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_refname(self):
    mod = EXAMPLE_MODULE + &#39;.&#39; + &#39;subpkg&#39;
    module = pdoc.Module(mod)
    var = module.doc[&#39;var&#39;]
    cls = module.doc[&#39;B&#39;]
    nested_cls = cls.doc[&#39;C&#39;]
    cls_var = cls.doc[&#39;var&#39;]
    method = cls.doc[&#39;f&#39;]

    self.assertEqual(pdoc.External(&#39;foo&#39;).refname, &#39;foo&#39;)
    self.assertEqual(module.refname, mod)
    self.assertEqual(var.refname, mod + &#39;.var&#39;)
    self.assertEqual(cls.refname, mod + &#39;.B&#39;)
    self.assertEqual(nested_cls.refname, mod + &#39;.B.C&#39;)
    self.assertEqual(cls_var.refname, mod + &#39;.B.var&#39;)
    self.assertEqual(method.refname, mod + &#39;.B.f&#39;)

    # Inherited method&#39;s refname points to class&#39; implicit copy
    pdoc.link_inheritance()
    self.assertEqual(cls.doc[&#39;inherited&#39;].refname, mod + &#39;.B.inherited&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_sorting"><code class="name flex">
<span>def <span class="ident">test_sorting</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L892-L916" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unittest.skipIf(sys.version_info &lt; (3, 6), reason=&#34;only deterministic on CPython 3.6+&#34;)
def test_sorting(self):
    module = pdoc.Module(EXAMPLE_MODULE)

    sorted_variables = module.variables()
    unsorted_variables = module.variables(sort=False)
    self.assertNotEqual(sorted_variables, unsorted_variables)
    self.assertEqual(sorted_variables, sorted(unsorted_variables))

    sorted_functions = module.functions()
    unsorted_functions = module.functions(sort=False)
    self.assertNotEqual(sorted_functions, unsorted_functions)
    self.assertEqual(sorted_functions, sorted(unsorted_functions))

    sorted_classes = module.classes()
    unsorted_classes = module.classes(sort=False)
    self.assertNotEqual(sorted_classes, unsorted_classes)
    self.assertEqual(sorted_classes, sorted(unsorted_classes))

    cls = module.doc[&#34;Docformats&#34;]

    sorted_methods = cls.methods()
    unsorted_methods = cls.methods(sort=False)
    self.assertNotEqual(sorted_methods, unsorted_methods)
    self.assertEqual(sorted_methods, sorted(unsorted_methods))</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_subclasses"><code class="name flex">
<span>def <span class="ident">test_subclasses</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L656-L685" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@ignore_warnings
def test_subclasses(self):
    class A:
        pass

    class B(type):
        pass

    class C(A):
        pass

    class D(B):
        pass

    class G(C):
        pass

    class F(C):
        pass

    class E(C):
        pass

    mod = pdoc.Module(pdoc)
    self.assertEqual([x.refname for x in pdoc.Class(&#39;A&#39;, mod, A).subclasses()],
                     [mod.find_class(C).refname])
    self.assertEqual([x.refname for x in pdoc.Class(&#39;B&#39;, mod, B).subclasses()],
                     [mod.find_class(D).refname])
    self.assertEqual([x.refname for x in pdoc.Class(&#39;C&#39;, mod, C).subclasses()],
                     [mod.find_class(x).refname for x in (E, F, G)])</code></pre>
</details>
</dd>
<dt id="pdoc.test.ApiTest.test_url"><code class="name flex">
<span>def <span class="ident">test_url</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L876-L890" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_url(self):
    mod = pdoc.Module(EXAMPLE_MODULE)
    pdoc.link_inheritance()

    c = mod.doc[&#39;D&#39;]
    self.assertEqual(c.url(), &#39;example_pkg/index.html#example_pkg.D&#39;)
    self.assertEqual(c.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D&#39;)
    self.assertEqual(c.url(relative_to=c.module), &#39;#example_pkg.D&#39;)
    self.assertEqual(c.url(top_ancestor=True), c.url())  # Public classes do link to themselves

    f = c.doc[&#39;overridden&#39;]
    self.assertEqual(f.url(), &#39;example_pkg/index.html#example_pkg.D.overridden&#39;)
    self.assertEqual(f.url(link_prefix=&#39;/&#39;), &#39;/example_pkg/index.html#example_pkg.D.overridden&#39;)
    self.assertEqual(f.url(relative_to=c.module), &#39;#example_pkg.D.overridden&#39;)
    self.assertEqual(f.url(top_ancestor=1), &#39;example_pkg/index.html#example_pkg.B.overridden&#39;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pdoc.test.CliTest"><code class="flex name class">
<span>class <span class="ident">CliTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>Command-line interface unit tests.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L92-L383" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class CliTest(unittest.TestCase):
    &#34;&#34;&#34;
    Command-line interface unit tests.
    &#34;&#34;&#34;
    ALL_FILES = [
        &#39;example_pkg&#39;,
        &#39;example_pkg/index.html&#39;,
        &#39;example_pkg/index.m.html&#39;,
        &#39;example_pkg/module.html&#39;,
        &#39;example_pkg/_private&#39;,
        &#39;example_pkg/_private/index.html&#39;,
        &#39;example_pkg/_private/module.html&#39;,
        &#39;example_pkg/subpkg&#39;,
        &#39;example_pkg/subpkg/_private.html&#39;,
        &#39;example_pkg/subpkg/index.html&#39;,
        &#39;example_pkg/subpkg2&#39;,
        &#39;example_pkg/subpkg2/_private.html&#39;,
        &#39;example_pkg/subpkg2/module.html&#39;,
        &#39;example_pkg/subpkg2/index.html&#39;,
    ]
    PUBLIC_FILES = [f for f in ALL_FILES if &#39;/_&#39; not in f]

    if os.name == &#39;nt&#39;:
        ALL_FILES = [i.replace(&#39;/&#39;, &#39;\\&#39;) for i in ALL_FILES]
        PUBLIC_FILES = [i.replace(&#39;/&#39;, &#39;\\&#39;) for i in PUBLIC_FILES]

    def setUp(self):
        pdoc.reset()

    def _basic_html_assertions(self, expected_files=PUBLIC_FILES):
        # Output directory tree layout is as expected
        files = glob(&#39;**&#39;, recursive=True)
        self.assertEqual(sorted(files), sorted(expected_files))

    def _check_files(self, include_patterns=(), exclude_patterns=(), file_pattern=&#39;**/*.html&#39;):
        files = glob(file_pattern, recursive=True)
        assert files
        for file in files:
            with open(file) as f:
                contents = f.read()
                for pattern in include_patterns:
                    self.assertIn(pattern, contents)
                for pattern in exclude_patterns:
                    self.assertNotIn(pattern, contents)

    def test_html(self):
        include_patterns = [
            &#39;a=&amp;lt;object&#39;,
            &#39;CONST docstring&#39;,
            &#39;var docstring&#39;,
            &#39;foreign_var&#39;,
            &#39;foreign var docstring&#39;,
            &#39;A&#39;,
            &#39;A.overridden docstring&#39;,
            &#39;A.overridden_same_docstring docstring&#39;,
            &#39;A.inherited&#39;,
            &#39;B docstring&#39;,
            &#39;B.overridden docstring&#39;,
            &#39;builtins.int&#39;,
            &#39;External refs: &#39;,
            &#39;&gt;sys.version&lt;&#39;,
            &#39;B.CONST docstring&#39;,
            &#39;B.var docstring&#39;,
            &#39;b=1&#39;,
            &#39;*args&#39;,
            &#39;**kwargs&#39;,
            &#39;x, y, z, w&#39;,
            &#39;instance_var&#39;,
            &#39;instance var docstring&#39;,
            &#39;B.f docstring&#39;,
            &#39;B.static docstring&#39;,
            &#39;B.cls docstring&#39;,
            &#39;B.p docstring&#39;,
            &#39;B.C docstring&#39;,
            &#39;B.overridden docstring&#39;,

            &#39;&lt;code&gt;__init__&lt;/code&gt; docstring&#39;,
            &#39; class=&#34;ident&#34;&gt;static&#39;,
        ]
        exclude_patterns = [
            &#39;&lt;object &#39;,
            &#39; class=&#34;ident&#34;&gt;_private&#39;,
            &#39; class=&#34;ident&#34;&gt;_Private&#39;,
            &#39;non_callable_routine&#39;,
        ]
        package_files = {
            &#39;&#39;: self.PUBLIC_FILES,
            &#39;.subpkg2&#39;: [f for f in self.PUBLIC_FILES
                         if &#39;subpkg2&#39; in f or f == EXAMPLE_MODULE],
            &#39;._private&#39;: [f for f in self.ALL_FILES
                          if EXAMPLE_MODULE + &#39;/_private&#39; in f or f == EXAMPLE_MODULE],
        }
        for package, expected_files in package_files.items():
            with self.subTest(package=package):
                with run_html(EXAMPLE_MODULE + package,
                              &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                              config=&#39;show_source_code=False&#39;):
                    self._basic_html_assertions(expected_files)
                    self._check_files(include_patterns, exclude_patterns)

        filenames_files = {
            (&#39;module.py&#39;,): [&#39;module.html&#39;],
            (&#39;module.py&#39;, &#39;subpkg2&#39;): [&#39;module.html&#39;, &#39;subpkg2&#39;,
                                       &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;],
        }
        with chdir(TESTS_BASEDIR):
            for filenames, expected_files in filenames_files.items():
                with self.subTest(filename=&#39;,&#39;.join(filenames)):
                    with run_html(*(os.path.join(EXAMPLE_MODULE, f) for f in filenames),
                                  &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                                  config=&#39;show_source_code=False&#39;):
                        self._basic_html_assertions(expected_files)
                        self._check_files(include_patterns, exclude_patterns)

    def test_html_multiple_files(self):
        with chdir(TESTS_BASEDIR):
            with run_html(EXAMPLE_MODULE + &#39;/module.py&#39;, EXAMPLE_MODULE + &#39;/subpkg2&#39;):
                self._basic_html_assertions(
                    [&#39;module.html&#39;, &#39;subpkg2&#39;, &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;])

    def test_html_identifier(self):
        for package in (&#39;&#39;, &#39;._private&#39;):
            with self.subTest(package=package), \
                    self.assertWarns(UserWarning) as cm:
                with run_html(EXAMPLE_MODULE + package, filter=&#39;A&#39;,
                              config=&#39;show_source_code=False&#39;):
                    self._check_files([&#39;A&#39;], [&#39;CONST&#39;, &#39;B docstring&#39;])
        self.assertIn(&#39;__pdoc__&#39;, cm.warning.args[0])

    def test_html_ref_links(self):
        with run_html(EXAMPLE_MODULE, config=&#39;show_source_code=False&#39;):
            self._check_files(
                file_pattern=EXAMPLE_MODULE + &#39;/index.html&#39;,
                include_patterns=[
                    &#39;href=&#34;#example_pkg.B&#34;&gt;&#39;,
                    &#39;href=&#34;#example_pkg.A&#34;&gt;&#39;,
                ],
            )

    def test_html_no_source(self):
        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, html_no_source=None):
            self._basic_html_assertions()
            self._check_files(exclude_patterns=[&#39;class=&#34;source&#34;&#39;, &#39;Hidden&#39;])

    def test_force(self):
        with run_html(EXAMPLE_MODULE):
            with redirect_streams() as (stdout, stderr):
                returncode = run(EXAMPLE_MODULE, _check=False, html=None, output_dir=os.getcwd())
                self.assertNotEqual(returncode, 0)
                self.assertNotEqual(stderr.getvalue(), &#39;&#39;)

            with redirect_streams() as (stdout, stderr):
                returncode = run(EXAMPLE_MODULE, html=None, force=None, output_dir=os.getcwd())
                self.assertEqual(returncode, 0)
                self.assertEqual(stderr.getvalue(), &#39;&#39;)

    def test_external_links(self):
        with run_html(EXAMPLE_MODULE):
            self._basic_html_assertions()
            self._check_files(exclude_patterns=[&#39;&lt;a href=&#34;/sys.version.ext&#34;&#39;])

        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, external_links=None):
            self._basic_html_assertions()
            self._check_files([&#39;&lt;a title=&#34;sys.version&#34; href=&#34;/sys.version.ext&#34;&#39;])

    def test_template_dir(self):
        old_tpl_dirs = pdoc.tpl_lookup.directories.copy()
        # Prevent loading incorrect template cached from prev runs
        pdoc.tpl_lookup._collection.clear()
        try:
            with run_html(EXAMPLE_MODULE, template_dir=TESTS_BASEDIR):
                self._basic_html_assertions()
                self._check_files([&#39;FOOBAR&#39;, &#39;/* Empty CSS */&#39;], [&#39;coding: utf-8&#39;])
        finally:
            pdoc.tpl_lookup.directories = old_tpl_dirs
            pdoc.tpl_lookup._collection.clear()

    def test_link_prefix(self):
        with self.assertWarns(DeprecationWarning),\
                run_html(EXAMPLE_MODULE, link_prefix=&#39;/foobar/&#39;):
            self._basic_html_assertions()
            self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])

    def test_text(self):
        include_patterns = [
            &#39;object_as_arg_default(*args, a=&lt;object &#39;,
            &#39;CONST docstring&#39;,
            &#39;var docstring&#39;,
            &#39;foreign_var&#39;,
            &#39;foreign var docstring&#39;,
            &#39;A&#39;,
            &#39;A.overridden docstring&#39;,
            &#39;A.overridden_same_docstring docstring&#39;,
            &#39;A.inherited&#39;,
            &#39;B docstring&#39;,
            &#39;B.overridden docstring&#39;,
            &#39;builtins.int&#39;,
            &#39;External refs: &#39;,
            &#39;sys.version&#39;,
            &#39;B.CONST docstring&#39;,
            &#39;B.var docstring&#39;,
            &#39;x, y, z, w&#39;,
            &#39;`__init__` docstring&#39;,
            &#39;instance_var&#39;,
            &#39;instance var docstring&#39;,
            &#39;b=1&#39;,
            &#39;*args&#39;,
            &#39;**kwargs&#39;,
            &#39;B.f docstring&#39;,
            &#39;B.static docstring&#39;,
            &#39;B.cls docstring&#39;,
            &#39;B.p docstring&#39;,
            &#39;C&#39;,
            &#39;B.overridden docstring&#39;,
        ]
        exclude_patterns = [
            &#39;_private&#39;,
            &#39;_Private&#39;,
            &#39;subprocess&#39;,
            &#39;Hidden&#39;,
            &#39;non_callable_routine&#39;,
        ]

        with self.subTest(package=EXAMPLE_MODULE):
            with redirect_streams() as (stdout, _):
                run(EXAMPLE_MODULE, config=&#39;show_type_annotations=False&#39;)
                out = stdout.getvalue()

            header = &#39;Module {}\n{:=&lt;{}}&#39;.format(EXAMPLE_MODULE, &#39;&#39;,
                                                 len(&#39;Module &#39;) + len(EXAMPLE_MODULE))
            self.assertIn(header, out)
            for pattern in include_patterns:
                self.assertIn(pattern, out)
            for pattern in exclude_patterns:
                self.assertNotIn(pattern, out)

        with chdir(TESTS_BASEDIR):
            for files in ((&#39;module.py&#39;,),
                          (&#39;module.py&#39;, &#39;subpkg2&#39;)):
                with self.subTest(filename=&#39;,&#39;.join(files)):
                    with redirect_streams() as (stdout, _):
                        run(*(os.path.join(EXAMPLE_MODULE, f) for f in files))
                        out = stdout.getvalue()
                    for f in files:
                        header = &#39;Module {}\n&#39;.format(os.path.splitext(f)[0])
                        self.assertIn(header, out)

    def test_text_identifier(self):
        with redirect_streams() as (stdout, _):
            run(EXAMPLE_MODULE, filter=&#39;A&#39;)
            out = stdout.getvalue()
        self.assertIn(&#39;A&#39;, out)
        self.assertIn(&#39;### Descendants\n\n    * example_pkg.B&#39;, out)
        self.assertNotIn(&#39;CONST&#39;, out)
        self.assertNotIn(&#39;B docstring&#39;, out)

    def test_pdf(self):
        with redirect_streams() as (stdout, stderr):
            run(&#39;pdoc&#39;, pdf=None)
            out = stdout.getvalue()
            err = stderr.getvalue()
        self.assertIn(&#39;pdoc3.github.io&#39;, out)
        self.assertIn(&#39;pandoc&#39;, err)

        self.assertIn(str(inspect.signature(pdoc.Doc.__init__)).replace(&#39;self, &#39;, &#39;&#39;),
                      out)

    def test_config(self):
        with run_html(EXAMPLE_MODULE, config=&#39;link_prefix=&#34;/foobar/&#34;&#39;):
            self._basic_html_assertions()
            self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])

    def test_output_text(self):
        with temp_dir() as path:
            run(EXAMPLE_MODULE, output_dir=path)
            with chdir(path):
                self._basic_html_assertions([file.replace(&#39;.html&#39;, &#39;.md&#39;)
                                             for file in self.PUBLIC_FILES])

    def test_google_analytics(self):
        expected = [&#39;google-analytics.com&#39;]
        with run_html(EXAMPLE_MODULE):
            self._check_files((), exclude_patterns=expected)
        with run_html(EXAMPLE_MODULE, config=&#39;google_analytics=&#34;UA-xxxxxx-y&#34;&#39;):
            self._check_files(expected)

    def test_relative_dir_path(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            with run_html(&#39;.&#39;):
                self._check_files(())</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pdoc.test.CliTest.ALL_FILES"><code class="name">var <span class="ident">ALL_FILES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pdoc.test.CliTest.PUBLIC_FILES"><code class="name">var <span class="ident">PUBLIC_FILES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pdoc.test.CliTest.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L118-L119" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def setUp(self):
    pdoc.reset()</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_config"><code class="name flex">
<span>def <span class="ident">test_config</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L361-L364" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_config(self):
    with run_html(EXAMPLE_MODULE, config=&#39;link_prefix=&#34;/foobar/&#34;&#39;):
        self._basic_html_assertions()
        self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_external_links"><code class="name flex">
<span>def <span class="ident">test_external_links</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L249-L257" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_external_links(self):
    with run_html(EXAMPLE_MODULE):
        self._basic_html_assertions()
        self._check_files(exclude_patterns=[&#39;&lt;a href=&#34;/sys.version.ext&#34;&#39;])

    with self.assertWarns(DeprecationWarning),\
            run_html(EXAMPLE_MODULE, external_links=None):
        self._basic_html_assertions()
        self._check_files([&#39;&lt;a title=&#34;sys.version&#34; href=&#34;/sys.version.ext&#34;&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_force"><code class="name flex">
<span>def <span class="ident">test_force</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L237-L247" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_force(self):
    with run_html(EXAMPLE_MODULE):
        with redirect_streams() as (stdout, stderr):
            returncode = run(EXAMPLE_MODULE, _check=False, html=None, output_dir=os.getcwd())
            self.assertNotEqual(returncode, 0)
            self.assertNotEqual(stderr.getvalue(), &#39;&#39;)

        with redirect_streams() as (stdout, stderr):
            returncode = run(EXAMPLE_MODULE, html=None, force=None, output_dir=os.getcwd())
            self.assertEqual(returncode, 0)
            self.assertEqual(stderr.getvalue(), &#39;&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_google_analytics"><code class="name flex">
<span>def <span class="ident">test_google_analytics</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L373-L378" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_google_analytics(self):
    expected = [&#39;google-analytics.com&#39;]
    with run_html(EXAMPLE_MODULE):
        self._check_files((), exclude_patterns=expected)
    with run_html(EXAMPLE_MODULE, config=&#39;google_analytics=&#34;UA-xxxxxx-y&#34;&#39;):
        self._check_files(expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_html"><code class="name flex">
<span>def <span class="ident">test_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L137-L204" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_html(self):
    include_patterns = [
        &#39;a=&amp;lt;object&#39;,
        &#39;CONST docstring&#39;,
        &#39;var docstring&#39;,
        &#39;foreign_var&#39;,
        &#39;foreign var docstring&#39;,
        &#39;A&#39;,
        &#39;A.overridden docstring&#39;,
        &#39;A.overridden_same_docstring docstring&#39;,
        &#39;A.inherited&#39;,
        &#39;B docstring&#39;,
        &#39;B.overridden docstring&#39;,
        &#39;builtins.int&#39;,
        &#39;External refs: &#39;,
        &#39;&gt;sys.version&lt;&#39;,
        &#39;B.CONST docstring&#39;,
        &#39;B.var docstring&#39;,
        &#39;b=1&#39;,
        &#39;*args&#39;,
        &#39;**kwargs&#39;,
        &#39;x, y, z, w&#39;,
        &#39;instance_var&#39;,
        &#39;instance var docstring&#39;,
        &#39;B.f docstring&#39;,
        &#39;B.static docstring&#39;,
        &#39;B.cls docstring&#39;,
        &#39;B.p docstring&#39;,
        &#39;B.C docstring&#39;,
        &#39;B.overridden docstring&#39;,

        &#39;&lt;code&gt;__init__&lt;/code&gt; docstring&#39;,
        &#39; class=&#34;ident&#34;&gt;static&#39;,
    ]
    exclude_patterns = [
        &#39;&lt;object &#39;,
        &#39; class=&#34;ident&#34;&gt;_private&#39;,
        &#39; class=&#34;ident&#34;&gt;_Private&#39;,
        &#39;non_callable_routine&#39;,
    ]
    package_files = {
        &#39;&#39;: self.PUBLIC_FILES,
        &#39;.subpkg2&#39;: [f for f in self.PUBLIC_FILES
                     if &#39;subpkg2&#39; in f or f == EXAMPLE_MODULE],
        &#39;._private&#39;: [f for f in self.ALL_FILES
                      if EXAMPLE_MODULE + &#39;/_private&#39; in f or f == EXAMPLE_MODULE],
    }
    for package, expected_files in package_files.items():
        with self.subTest(package=package):
            with run_html(EXAMPLE_MODULE + package,
                          &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                          config=&#39;show_source_code=False&#39;):
                self._basic_html_assertions(expected_files)
                self._check_files(include_patterns, exclude_patterns)

    filenames_files = {
        (&#39;module.py&#39;,): [&#39;module.html&#39;],
        (&#39;module.py&#39;, &#39;subpkg2&#39;): [&#39;module.html&#39;, &#39;subpkg2&#39;,
                                   &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;],
    }
    with chdir(TESTS_BASEDIR):
        for filenames, expected_files in filenames_files.items():
            with self.subTest(filename=&#39;,&#39;.join(filenames)):
                with run_html(*(os.path.join(EXAMPLE_MODULE, f) for f in filenames),
                              &#39;--config&#39;, &#39;show_type_annotations=False&#39;,
                              config=&#39;show_source_code=False&#39;):
                    self._basic_html_assertions(expected_files)
                    self._check_files(include_patterns, exclude_patterns)</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_html_identifier"><code class="name flex">
<span>def <span class="ident">test_html_identifier</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L212-L219" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_html_identifier(self):
    for package in (&#39;&#39;, &#39;._private&#39;):
        with self.subTest(package=package), \
                self.assertWarns(UserWarning) as cm:
            with run_html(EXAMPLE_MODULE + package, filter=&#39;A&#39;,
                          config=&#39;show_source_code=False&#39;):
                self._check_files([&#39;A&#39;], [&#39;CONST&#39;, &#39;B docstring&#39;])
    self.assertIn(&#39;__pdoc__&#39;, cm.warning.args[0])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_html_multiple_files"><code class="name flex">
<span>def <span class="ident">test_html_multiple_files</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L206-L210" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_html_multiple_files(self):
    with chdir(TESTS_BASEDIR):
        with run_html(EXAMPLE_MODULE + &#39;/module.py&#39;, EXAMPLE_MODULE + &#39;/subpkg2&#39;):
            self._basic_html_assertions(
                [&#39;module.html&#39;, &#39;subpkg2&#39;, &#39;subpkg2/index.html&#39;, &#39;subpkg2/module.html&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_html_no_source"><code class="name flex">
<span>def <span class="ident">test_html_no_source</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L231-L235" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_html_no_source(self):
    with self.assertWarns(DeprecationWarning),\
            run_html(EXAMPLE_MODULE, html_no_source=None):
        self._basic_html_assertions()
        self._check_files(exclude_patterns=[&#39;class=&#34;source&#34;&#39;, &#39;Hidden&#39;])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_html_ref_links"><code class="name flex">
<span>def <span class="ident">test_html_ref_links</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L221-L229" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_html_ref_links(self):
    with run_html(EXAMPLE_MODULE, config=&#39;show_source_code=False&#39;):
        self._check_files(
            file_pattern=EXAMPLE_MODULE + &#39;/index.html&#39;,
            include_patterns=[
                &#39;href=&#34;#example_pkg.B&#34;&gt;&#39;,
                &#39;href=&#34;#example_pkg.A&#34;&gt;&#39;,
            ],
        )</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_link_prefix"><code class="name flex">
<span>def <span class="ident">test_link_prefix</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L271-L275" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_link_prefix(self):
    with self.assertWarns(DeprecationWarning),\
            run_html(EXAMPLE_MODULE, link_prefix=&#39;/foobar/&#39;):
        self._basic_html_assertions()
        self._check_files([&#39;/foobar/&#39; + EXAMPLE_MODULE])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_output_text"><code class="name flex">
<span>def <span class="ident">test_output_text</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L366-L371" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_output_text(self):
    with temp_dir() as path:
        run(EXAMPLE_MODULE, output_dir=path)
        with chdir(path):
            self._basic_html_assertions([file.replace(&#39;.html&#39;, &#39;.md&#39;)
                                         for file in self.PUBLIC_FILES])</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_pdf"><code class="name flex">
<span>def <span class="ident">test_pdf</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L350-L359" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_pdf(self):
    with redirect_streams() as (stdout, stderr):
        run(&#39;pdoc&#39;, pdf=None)
        out = stdout.getvalue()
        err = stderr.getvalue()
    self.assertIn(&#39;pdoc3.github.io&#39;, out)
    self.assertIn(&#39;pandoc&#39;, err)

    self.assertIn(str(inspect.signature(pdoc.Doc.__init__)).replace(&#39;self, &#39;, &#39;&#39;),
                  out)</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_relative_dir_path"><code class="name flex">
<span>def <span class="ident">test_relative_dir_path</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L380-L383" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_relative_dir_path(self):
    with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
        with run_html(&#39;.&#39;):
            self._check_files(())</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_template_dir"><code class="name flex">
<span>def <span class="ident">test_template_dir</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L259-L269" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_template_dir(self):
    old_tpl_dirs = pdoc.tpl_lookup.directories.copy()
    # Prevent loading incorrect template cached from prev runs
    pdoc.tpl_lookup._collection.clear()
    try:
        with run_html(EXAMPLE_MODULE, template_dir=TESTS_BASEDIR):
            self._basic_html_assertions()
            self._check_files([&#39;FOOBAR&#39;, &#39;/* Empty CSS */&#39;], [&#39;coding: utf-8&#39;])
    finally:
        pdoc.tpl_lookup.directories = old_tpl_dirs
        pdoc.tpl_lookup._collection.clear()</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_text"><code class="name flex">
<span>def <span class="ident">test_text</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L277-L339" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_text(self):
    include_patterns = [
        &#39;object_as_arg_default(*args, a=&lt;object &#39;,
        &#39;CONST docstring&#39;,
        &#39;var docstring&#39;,
        &#39;foreign_var&#39;,
        &#39;foreign var docstring&#39;,
        &#39;A&#39;,
        &#39;A.overridden docstring&#39;,
        &#39;A.overridden_same_docstring docstring&#39;,
        &#39;A.inherited&#39;,
        &#39;B docstring&#39;,
        &#39;B.overridden docstring&#39;,
        &#39;builtins.int&#39;,
        &#39;External refs: &#39;,
        &#39;sys.version&#39;,
        &#39;B.CONST docstring&#39;,
        &#39;B.var docstring&#39;,
        &#39;x, y, z, w&#39;,
        &#39;`__init__` docstring&#39;,
        &#39;instance_var&#39;,
        &#39;instance var docstring&#39;,
        &#39;b=1&#39;,
        &#39;*args&#39;,
        &#39;**kwargs&#39;,
        &#39;B.f docstring&#39;,
        &#39;B.static docstring&#39;,
        &#39;B.cls docstring&#39;,
        &#39;B.p docstring&#39;,
        &#39;C&#39;,
        &#39;B.overridden docstring&#39;,
    ]
    exclude_patterns = [
        &#39;_private&#39;,
        &#39;_Private&#39;,
        &#39;subprocess&#39;,
        &#39;Hidden&#39;,
        &#39;non_callable_routine&#39;,
    ]

    with self.subTest(package=EXAMPLE_MODULE):
        with redirect_streams() as (stdout, _):
            run(EXAMPLE_MODULE, config=&#39;show_type_annotations=False&#39;)
            out = stdout.getvalue()

        header = &#39;Module {}\n{:=&lt;{}}&#39;.format(EXAMPLE_MODULE, &#39;&#39;,
                                             len(&#39;Module &#39;) + len(EXAMPLE_MODULE))
        self.assertIn(header, out)
        for pattern in include_patterns:
            self.assertIn(pattern, out)
        for pattern in exclude_patterns:
            self.assertNotIn(pattern, out)

    with chdir(TESTS_BASEDIR):
        for files in ((&#39;module.py&#39;,),
                      (&#39;module.py&#39;, &#39;subpkg2&#39;)):
            with self.subTest(filename=&#39;,&#39;.join(files)):
                with redirect_streams() as (stdout, _):
                    run(*(os.path.join(EXAMPLE_MODULE, f) for f in files))
                    out = stdout.getvalue()
                for f in files:
                    header = &#39;Module {}\n&#39;.format(os.path.splitext(f)[0])
                    self.assertIn(header, out)</code></pre>
</details>
</dd>
<dt id="pdoc.test.CliTest.test_text_identifier"><code class="name flex">
<span>def <span class="ident">test_text_identifier</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L341-L348" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_text_identifier(self):
    with redirect_streams() as (stdout, _):
        run(EXAMPLE_MODULE, filter=&#39;A&#39;)
        out = stdout.getvalue()
    self.assertIn(&#39;A&#39;, out)
    self.assertIn(&#39;### Descendants\n\n    * example_pkg.B&#39;, out)
    self.assertNotIn(&#39;CONST&#39;, out)
    self.assertNotIn(&#39;B docstring&#39;, out)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pdoc.test.Docformats"><code class="flex name class">
<span>class <span class="ident">Docformats</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1054-L1347" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Docformats(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        cls._module = pdoc.Module(pdoc)
        cls._docmodule = pdoc.import_module(EXAMPLE_MODULE)

    @staticmethod
    def _link(dobj, *args, **kwargs):
        return &#39;&lt;a&gt;{}&lt;/a&gt;&#39;.format(dobj.refname)

    def test_numpy(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Documentation&lt;/strong&gt;: &lt;a href=&#34;https://pdoc3.github.io/pdoc/doc/pdoc/&#34;&gt;https://pdoc3.github.io/pdoc/doc/pdoc/&lt;/a&gt;
&lt;strong&gt;Source Code&lt;/strong&gt;: &lt;a href=&#34;https://github.com/pdoc3/&#34;&gt;https://github.com/pdoc3/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x1&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;x2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;array_like&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;Input arrays,
description of &lt;code&gt;x1&lt;/code&gt;, &lt;code&gt;x2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;1.5.0&lt;/p&gt;
&lt;/div&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;{ NoneType, &#39;B&#39;, &#39;C&#39; }&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;n&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt; or &lt;code&gt;list&lt;/code&gt; of &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of num&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;**kwargs&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;Passed on.&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;complex&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;Union[Set[&lt;a&gt;pdoc.Doc&lt;/a&gt;, &lt;a&gt;pdoc.Function&lt;/a&gt;], &lt;a&gt;pdoc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The &lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;s of the new signal.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;output&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;foo&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;When something.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises_1&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;p&gt;None.&lt;/p&gt;
&lt;h2 id=&#34;invalid&#34;&gt;Invalid&lt;/h2&gt;
&lt;p&gt;no match&lt;/p&gt;
&lt;h2 id=&#34;see-also&#34;&gt;See Also&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;fromstring&lt;/code&gt;, &lt;code&gt;loadtxt&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;see-also_1&#34;&gt;See Also&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.text&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Function a with its description.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;scipy.random.norm&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Random variates, PDFs, etc.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;A class description that spans several lines.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;notes&#34;&gt;Notes&lt;/h2&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;
&lt;h3 id=&#34;h3-title&#34;&gt;H3 Title&lt;/h3&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.numpy)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_numpy_curly_brace_expansion(self):
        # See: https://github.com/mwaskom/seaborn/blob/66191d8a179f1bfa42f03749bc4a07e1c0c08156/seaborn/regression.py#L514  # noqa: 501
        text = &#39;&#39;&#39;Parameters
----------
prefix_{x,y}_partial : str
    some description
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;prefix_{x,y}_partial&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;some description&lt;/dd&gt;
&lt;/dl&gt;&#39;&#39;&#39;
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_google(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.
Nomatch:&lt;/p&gt;
&lt;h2 id=&#34;args&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;Text1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;List[str]&lt;/code&gt;, optional,\
 default=&lt;code&gt;10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Text2&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;args_1&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt; or &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg2&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;test_sequence&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;2-dim numpy array of real numbers, size: N * D
- the test observation sequence.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;test_sequence =
code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Continue.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;passed around&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;issue_10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;description didn&#39;t work across multiple lines
if only a single item was listed. &lt;code&gt;&lt;a&gt;inspect.cleandoc()&lt;/a&gt;&lt;/code&gt;
somehow stripped the required extra indentation.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;Dict[int, &lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;AttributeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;The &lt;code&gt;Raises&lt;/code&gt; section is a list of all exceptions
that are relevant to the interface.&lt;/p&gt;
&lt;p&gt;and a third line.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;ValueError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;If &lt;code&gt;arg2&lt;/code&gt; is equal to &lt;code&gt;arg1&lt;/code&gt;.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Test a title without a blank line before it.&lt;/p&gt;
&lt;h2 id=&#34;args_2&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;A&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;a&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;p&gt;Examples in doctest format.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; a = [1,2,3]
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;todos&#34;&gt;Todos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;For module TODOs&lt;/li&gt;
&lt;/ul&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.google)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_doctests(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Need an intro paragrapgh.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; Then code is indented one level
line1
line2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Alternatively&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; doctest
fenced code works
always
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; nbytes(100)
&#39;100.0 bytes&#39;
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;some text&lt;/p&gt;
&lt;p&gt;some text&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; another doctest
line1
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;example&#34;&gt;Example&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; f()
Traceback (most recent call last):
    ...
Exception: something went wrong
&lt;/code&gt;&lt;/pre&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.doctests)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_reST_directives(self):
        expected = &#39;&#39;&#39;&lt;div class=&#34;admonition todo&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;TODO&lt;/p&gt;
&lt;p&gt;Create something.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition admonition&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Example&lt;/p&gt;
&lt;p&gt;Image shows something.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;admonition note&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Note&lt;/p&gt;
&lt;p&gt;Can only nest admonitions two levels.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now you know.&lt;/p&gt;
&lt;div class=&#34;admonition warning&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Warning&lt;/p&gt;
&lt;p&gt;Some warning
lines.&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Describe some func in a list
  across multiple lines:&lt;/p&gt;
&lt;div class=&#34;admonition deprecated&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Deprecated since version:&amp;ensp;3.1&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;spam&lt;/code&gt; instead.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;2.5&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;spam&lt;/em&gt; parameter.&lt;/p&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;admonition caution&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Caution&lt;/p&gt;
&lt;p&gt;Don&#39;t touch this!&lt;/p&gt;
&lt;/div&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.reST_directives)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)

    def test_reST_include(self):
        expected = &#39;&#39;&#39;&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;    x = 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1
x = 2
x = 3
x =&lt;/p&gt;&#39;&#39;&#39;
        mod = pdoc.Module(pdoc.import_module(
            os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_reST_include&#39;, &#39;test.py&#39;)))
        text = inspect.getdoc(mod.obj)
        html = to_html(text, module=mod)
        self.assertEqual(html, expected)

        # Ensure includes are resolved within docstrings already,
        # e.g. for `pdoc.html_helpers.extract_toc()` to work
        self.assertIn(&#39;Command-line interface&#39;,
                      pdoc.Module(pdoc).docstring)

    def test_urls(self):
        text = &#34;&#34;&#34;Beautiful Soup
http://www.foo.bar
http://www.foo.bar?q=&#34;foo&#34;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;https://foo.bar&gt;

Work [like this](http://foo/) and [like that].

[like that]: ftp://bar

data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D

```
http://url.com
```&#34;&#34;&#34;
        expected = &#34;&#34;&#34;&lt;p&gt;Beautiful Soup
&lt;a href=&#34;http://www.foo.bar&#34;&gt;http://www.foo.bar&lt;/a&gt;
&lt;a href=&#34;http://www.foo.bar?q=&amp;quot;foo&amp;quot;&#34;&gt;http://www.foo.bar?q=&#34;foo&#34;&lt;/a&gt;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;a href=&#34;https://foo.bar&#34;&gt;https://foo.bar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Work &lt;a href=&#34;http://foo/&#34;&gt;like this&lt;/a&gt; and &lt;a href=&#34;ftp://bar&#34;&gt;like that&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://url.com
&lt;/code&gt;&lt;/pre&gt;&#34;&#34;&#34;
        html = to_html(text)
        self.assertEqual(html, expected)

    def test_latex_math(self):
        expected = r&#39;&#39;&#39;&lt;p&gt;Inline equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.latex_math)
        html = to_html(text, module=self._module, link=self._link, latex_math=True)
        self.assertEqual(html, expected)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="pdoc.test.Docformats.setUpClass"><code class="name flex">
<span>def <span class="ident">setUpClass</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Hook method for setting up class fixture before running tests in the class.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1055-L1058" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@classmethod
def setUpClass(cls):
    cls._module = pdoc.Module(pdoc)
    cls._docmodule = pdoc.import_module(EXAMPLE_MODULE)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pdoc.test.Docformats.test_doctests"><code class="name flex">
<span>def <span class="ident">test_doctests</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1215-L1248" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_doctests(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Need an intro paragrapgh.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; Then code is indented one level
line1
line2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Alternatively&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; doctest
fenced code works
always
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; nbytes(100)
&#39;100.0 bytes&#39;
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;some text&lt;/p&gt;
&lt;p&gt;some text&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; another doctest
line1
line2
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;example&#34;&gt;Example&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; f()
Traceback (most recent call last):
    ...
Exception: something went wrong
&lt;/code&gt;&lt;/pre&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.doctests)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_google"><code class="name flex">
<span>def <span class="ident">test_google</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1144-L1213" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_google(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.
Nomatch:&lt;/p&gt;
&lt;h2 id=&#34;args&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;Text1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;List[str]&lt;/code&gt;, optional,\
 default=&lt;code&gt;10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Text2&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;args_1&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg1&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg1&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;arg2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt; or &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of arg2&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;test_sequence&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;2-dim numpy array of real numbers, size: N * D
- the test observation sequence.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;test_sequence =
code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Continue.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;passed around&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;issue_10&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;description didn&#39;t work across multiple lines
if only a single item was listed. &lt;code&gt;&lt;a&gt;inspect.cleandoc()&lt;/a&gt;&lt;/code&gt;
somehow stripped the required extra indentation.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;Dict[int, &lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;AttributeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;The &lt;code&gt;Raises&lt;/code&gt; section is a list of all exceptions
that are relevant to the interface.&lt;/p&gt;
&lt;p&gt;and a third line.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;ValueError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;If &lt;code&gt;arg2&lt;/code&gt; is equal to &lt;code&gt;arg1&lt;/code&gt;.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Test a title without a blank line before it.&lt;/p&gt;
&lt;h2 id=&#34;args_2&#34;&gt;Args&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;A&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;a&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;examples&#34;&gt;Examples&lt;/h2&gt;
&lt;p&gt;Examples in doctest format.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;&amp;gt;&amp;gt;&amp;gt; a = [1,2,3]
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;todos&#34;&gt;Todos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;For module TODOs&lt;/li&gt;
&lt;/ul&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.google)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_latex_math"><code class="name flex">
<span>def <span class="ident">test_latex_math</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1340-L1347" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_latex_math(self):
        expected = r&#39;&#39;&#39;&lt;p&gt;Inline equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Block equation: &lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;span class=&#34;MathJax_Preview&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &amp;lt; 3 &lt;/span&gt;&lt;script type=&#34;math/tex; mode=display&#34;&gt; v_t *\frac{1}{2}* j_i + [a] &lt; 3 &lt;/script&gt;&lt;/span&gt;&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.latex_math)
        html = to_html(text, module=self._module, link=self._link, latex_math=True)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_numpy"><code class="name flex">
<span>def <span class="ident">test_numpy</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1064-L1127" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_numpy(self):
        expected = &#39;&#39;&#39;&lt;p&gt;Summary line.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Documentation&lt;/strong&gt;: &lt;a href=&#34;https://pdoc3.github.io/pdoc/doc/pdoc/&#34;&gt;https://pdoc3.github.io/pdoc/doc/pdoc/&lt;/a&gt;
&lt;strong&gt;Source Code&lt;/strong&gt;: &lt;a href=&#34;https://github.com/pdoc3/&#34;&gt;https://github.com/pdoc3/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x1&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;x2&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;array_like&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;
&lt;p&gt;Input arrays,
description of &lt;code&gt;x1&lt;/code&gt;, &lt;code&gt;x2&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;1.5.0&lt;/p&gt;
&lt;/div&gt;
&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;x&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;{ NoneType, &#39;B&#39;, &#39;C&#39; }&lt;/code&gt;, optional&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;n&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;int&lt;/code&gt; or &lt;code&gt;list&lt;/code&gt; of &lt;code&gt;int&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Description of num&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;*args&lt;/code&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;code&gt;**kwargs&lt;/code&gt;&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;Passed on.&lt;/dd&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;complex&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;Union[Set[&lt;a&gt;pdoc.Doc&lt;/a&gt;, &lt;a&gt;pdoc.Function&lt;/a&gt;], &lt;a&gt;pdoc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The &lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;s of the new signal.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns&#34;&gt;Returns&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;output&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;List[&lt;a&gt;pdoc.Doc&lt;/a&gt;]&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;The output array&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;foo&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;When something.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;raises_1&#34;&gt;Raises&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;TypeError&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;&amp;nbsp;&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;returns_1&#34;&gt;Returns&lt;/h2&gt;
&lt;p&gt;None.&lt;/p&gt;
&lt;h2 id=&#34;invalid&#34;&gt;Invalid&lt;/h2&gt;
&lt;p&gt;no match&lt;/p&gt;
&lt;h2 id=&#34;see-also&#34;&gt;See Also&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;fromstring&lt;/code&gt;, &lt;code&gt;loadtxt&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;see-also_1&#34;&gt;See Also&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.text&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Function a with its description.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;scipy.random.norm&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;Random variates, PDFs, etc.&lt;/dd&gt;
&lt;dt&gt;&lt;code&gt;&lt;a&gt;pdoc.Doc&lt;/a&gt;&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;A class description that spans several lines.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h2 id=&#34;notes&#34;&gt;Notes&lt;/h2&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;
&lt;h3 id=&#34;h3-title&#34;&gt;H3 Title&lt;/h3&gt;
&lt;p&gt;Foo bar.&lt;/p&gt;&#39;&#39;&#39;  # noqa: E501
        text = inspect.getdoc(self._docmodule.numpy)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_numpy_curly_brace_expansion"><code class="name flex">
<span>def <span class="ident">test_numpy_curly_brace_expansion</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1129-L1142" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_numpy_curly_brace_expansion(self):
        # See: https://github.com/mwaskom/seaborn/blob/66191d8a179f1bfa42f03749bc4a07e1c0c08156/seaborn/regression.py#L514  # noqa: 501
        text = &#39;&#39;&#39;Parameters
----------
prefix_{x,y}_partial : str
    some description
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h2 id=&#34;parameters&#34;&gt;Parameters&lt;/h2&gt;
&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;&lt;code&gt;prefix_{x,y}_partial&lt;/code&gt;&lt;/strong&gt; :&amp;ensp;&lt;code&gt;str&lt;/code&gt;&lt;/dt&gt;
&lt;dd&gt;some description&lt;/dd&gt;
&lt;/dl&gt;&#39;&#39;&#39;
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_reST_directives"><code class="name flex">
<span>def <span class="ident">test_reST_directives</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1250-L1291" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_reST_directives(self):
        expected = &#39;&#39;&#39;&lt;div class=&#34;admonition todo&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;TODO&lt;/p&gt;
&lt;p&gt;Create something.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition admonition&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Example&lt;/p&gt;
&lt;p&gt;Image shows something.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;admonition note&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Note&lt;/p&gt;
&lt;p&gt;Can only nest admonitions two levels.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img alt=&#34;&#34; src=&#34;https://www.debian.org/logos/openlogo-nd-100.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now you know.&lt;/p&gt;
&lt;div class=&#34;admonition warning&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Warning&lt;/p&gt;
&lt;p&gt;Some warning
lines.&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Describe some func in a list
  across multiple lines:&lt;/p&gt;
&lt;div class=&#34;admonition deprecated&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Deprecated since version:&amp;ensp;3.1&lt;/p&gt;
&lt;p&gt;Use &lt;code&gt;spam&lt;/code&gt; instead.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;admonition versionadded&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Added in version:&amp;ensp;2.5&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;spam&lt;/em&gt; parameter.&lt;/p&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;admonition caution&#34;&gt;
&lt;p class=&#34;admonition-title&#34;&gt;Caution&lt;/p&gt;
&lt;p&gt;Don&#39;t touch this!&lt;/p&gt;
&lt;/div&gt;&#39;&#39;&#39;
        text = inspect.getdoc(self._docmodule.reST_directives)
        html = to_html(text, module=self._module, link=self._link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_reST_include"><code class="name flex">
<span>def <span class="ident">test_reST_include</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1293-L1310" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_reST_include(self):
        expected = &#39;&#39;&#39;&lt;pre&gt;&lt;code class=&#34;python&#34;&gt;    x = 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1
x = 2
x = 3
x =&lt;/p&gt;&#39;&#39;&#39;
        mod = pdoc.Module(pdoc.import_module(
            os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE, &#39;_reST_include&#39;, &#39;test.py&#39;)))
        text = inspect.getdoc(mod.obj)
        html = to_html(text, module=mod)
        self.assertEqual(html, expected)

        # Ensure includes are resolved within docstrings already,
        # e.g. for `pdoc.html_helpers.extract_toc()` to work
        self.assertIn(&#39;Command-line interface&#39;,
                      pdoc.Module(pdoc).docstring)</code></pre>
</details>
</dd>
<dt id="pdoc.test.Docformats.test_urls"><code class="name flex">
<span>def <span class="ident">test_urls</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1312-L1338" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_urls(self):
        text = &#34;&#34;&#34;Beautiful Soup
http://www.foo.bar
http://www.foo.bar?q=&#34;foo&#34;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;https://foo.bar&gt;

Work [like this](http://foo/) and [like that].

[like that]: ftp://bar

data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D

```
http://url.com
```&#34;&#34;&#34;
        expected = &#34;&#34;&#34;&lt;p&gt;Beautiful Soup
&lt;a href=&#34;http://www.foo.bar&#34;&gt;http://www.foo.bar&lt;/a&gt;
&lt;a href=&#34;http://www.foo.bar?q=&amp;quot;foo&amp;quot;&#34;&gt;http://www.foo.bar?q=&#34;foo&#34;&lt;/a&gt;
&lt;a href=&#34;https://travis-ci.org/cs01/pygdbmi&#34;&gt;&lt;img src=&#34;https://foo&#34; /&gt;&lt;/a&gt;
&lt;a href=&#34;https://foo.bar&#34;&gt;https://foo.bar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Work &lt;a href=&#34;http://foo/&#34;&gt;like this&lt;/a&gt; and &lt;a href=&#34;ftp://bar&#34;&gt;like that&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;data:text/plain;base64,SGVsbG8sIFdvcmxkIQ%3D%3D&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://url.com
&lt;/code&gt;&lt;/pre&gt;&#34;&#34;&#34;
        html = to_html(text)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pdoc.test.HtmlHelpersTest"><code class="flex name class">
<span>class <span class="ident">HtmlHelpersTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>Unit tests for helper functions for producing HTML.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L924-L1051" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class HtmlHelpersTest(unittest.TestCase):
    &#34;&#34;&#34;
    Unit tests for helper functions for producing HTML.
    &#34;&#34;&#34;

    def test_minify_css(self):
        css = &#39;a { color: white; } /*comment*/ b {;}&#39;
        minified = minify_css(css)
        self.assertNotIn(&#39; &#39;, minified)
        self.assertNotIn(&#39;;}&#39;, minified)
        self.assertNotIn(&#39;*&#39;, minified)

    def test_minify_html(self):
        html = &#39;  &lt;p&gt;   a   &lt;/p&gt;    &lt;pre&gt;    a\n    b&lt;/pre&gt;    c   \n    d   &#39;
        expected = &#39;\n&lt;p&gt;\na\n&lt;/p&gt;\n&lt;pre&gt;    a\n    b&lt;/pre&gt;\nc\nd\n&#39;
        minified = minify_html(html)
        self.assertEqual(minified, expected)

    def test_glimpse(self):
        text = &#39;foo bar\n\nbaz&#39;
        self.assertEqual(glimpse(text), &#39;foo bar …&#39;)
        self.assertEqual(glimpse(text, max_length=8, paragraph=False), &#39;foo …&#39;)
        self.assertEqual(glimpse(&#39;Foo bar\n-------&#39;), &#39;Foo bar&#39;)

    def test_to_html(self):
        text = &#39;&#39;&#39;# Title

`pdoc.Module` is a `Doc`, not `dict`.

ref with underscore: `_x_x_`

```
code block
```
reference: `package.foo`
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h1 id=&#34;title&#34;&gt;Title&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Module&#34;&gt;Module&lt;/a&gt;&lt;/code&gt; is a &lt;code&gt;&lt;a href=&#34;#pdoc.Doc&#34;&gt;Doc&lt;/a&gt;&lt;/code&gt;,\
 not &lt;code&gt;dict&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ref with underscore: &lt;code&gt;&lt;a href=&#34;#pdoc._x_x_&#34;&gt;_x_x_&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;code block
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;reference: &lt;code&gt;&lt;a href=&#34;/package.foo.ext&#34;&gt;package.foo&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;&#39;&#39;

        module = pdoc.Module(pdoc)
        module.doc[&#39;_x_x_&#39;] = pdoc.Variable(&#39;_x_x_&#39;, module, &#39;&#39;)

        def link(dobj):
            return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=module), dobj.qualname)

        html = to_html(text, module=module, link=link)
        self.assertEqual(html, expected)

        self.assertEqual(to_html(&#39;`pdoc.Doc.url()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Doc.url&#34;&gt;Doc.url&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)

        self.assertEqual(to_html(&#39;`foo.f()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;/foo.f().ext&#34;&gt;foo.f()&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)

    def test_to_html_refname(self):
        text = &#39;&#39;&#39;
[`pdoc` x][pdoc] `pdoc`
[x `pdoc`][pdoc] `[pdoc]()`

`__x__`

[`pdoc`](#)
[``pdoc` ``](#)
[```pdoc```](#)

```
pdoc
```

[pdoc]: #pdoc
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;\
&lt;p&gt;&lt;a href=&#34;#pdoc&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt; x&lt;/a&gt; &lt;code&gt;&lt;a&gt;pdoc&lt;/a&gt;&lt;/code&gt;
&lt;a href=&#34;#pdoc&#34;&gt;x &lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt; &lt;code&gt;[&lt;a&gt;pdoc&lt;/a&gt;]()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;__x__&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc`&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pdoc
&lt;/code&gt;&lt;/pre&gt;\
&#39;&#39;&#39;

        def link(dobj):
            return &#39;&lt;a&gt;{}&lt;/a&gt;&#39;.format(dobj.qualname)

        html = to_html(text, module=pdoc.Module(pdoc), link=link)
        self.assertEqual(html, expected)

    def test_to_html_refname_warning(self):
        mod = pdoc.Module(EXAMPLE_MODULE)

        def f():
            &#34;&#34;&#34;Reference to some `example_pkg.nonexisting` object&#34;&#34;&#34;

        mod.doc[&#39;__f&#39;] = pdoc.Function(&#39;__f&#39;, mod, f)
        with self.assertWarns(ReferenceWarning) as cm:
            mod.html()
        del mod.doc[&#39;__f&#39;]
        self.assertIn(&#39;example_pkg.nonexisting&#39;, cm.warning.args[0])

    def test_extract_toc(self):
        text = &#39;xxx\n\n# Title\n\nfoo\n\n## Subtitle\n\nbar&#39;
        expected = &#39;&#39;&#39;&lt;div class=&#34;toc&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#title&#34;&gt;Title&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#subtitle&#34;&gt;Subtitle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&#39;&#39;&#39;
        toc = extract_toc(text)
        self.assertEqual(toc, expected)

    @unittest.skipIf(shutil.which(&#34;git&#34;) is None or not os.path.exists(&#39;.git&#39;),
                     &#34;git not installed or we&#39;re not within git repo&#34;)
    def test_format_git_link(self):
        url = format_git_link(
            template=&#39;https://github.com/pdoc3/pdoc/blob/{commit}/{path}#L{start_line}-L{end_line}&#39;,
            dobj=pdoc.Module(EXAMPLE_MODULE).find_ident(&#39;module.foo&#39;),
        )
        self.assertRegex(url, r&#34;https://github.com/pdoc3/pdoc/blob/[0-9a-f]{40}&#34;
                              r&#34;/pdoc/test/example_pkg/module.py#L\d+-L\d+&#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pdoc.test.HtmlHelpersTest.test_extract_toc"><code class="name flex">
<span>def <span class="ident">test_extract_toc</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1030-L1041" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_extract_toc(self):
        text = &#39;xxx\n\n# Title\n\nfoo\n\n## Subtitle\n\nbar&#39;
        expected = &#39;&#39;&#39;&lt;div class=&#34;toc&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#title&#34;&gt;Title&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#subtitle&#34;&gt;Subtitle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;&#39;&#39;&#39;
        toc = extract_toc(text)
        self.assertEqual(toc, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_format_git_link"><code class="name flex">
<span>def <span class="ident">test_format_git_link</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1043-L1051" class="git-link">Browse git</a>
</summary>
<pre><code class="python">@unittest.skipIf(shutil.which(&#34;git&#34;) is None or not os.path.exists(&#39;.git&#39;),
                 &#34;git not installed or we&#39;re not within git repo&#34;)
def test_format_git_link(self):
    url = format_git_link(
        template=&#39;https://github.com/pdoc3/pdoc/blob/{commit}/{path}#L{start_line}-L{end_line}&#39;,
        dobj=pdoc.Module(EXAMPLE_MODULE).find_ident(&#39;module.foo&#39;),
    )
    self.assertRegex(url, r&#34;https://github.com/pdoc3/pdoc/blob/[0-9a-f]{40}&#34;
                          r&#34;/pdoc/test/example_pkg/module.py#L\d+-L\d+&#34;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_glimpse"><code class="name flex">
<span>def <span class="ident">test_glimpse</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L942-L946" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_glimpse(self):
    text = &#39;foo bar\n\nbaz&#39;
    self.assertEqual(glimpse(text), &#39;foo bar …&#39;)
    self.assertEqual(glimpse(text, max_length=8, paragraph=False), &#39;foo …&#39;)
    self.assertEqual(glimpse(&#39;Foo bar\n-------&#39;), &#39;Foo bar&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_minify_css"><code class="name flex">
<span>def <span class="ident">test_minify_css</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L929-L934" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_minify_css(self):
    css = &#39;a { color: white; } /*comment*/ b {;}&#39;
    minified = minify_css(css)
    self.assertNotIn(&#39; &#39;, minified)
    self.assertNotIn(&#39;;}&#39;, minified)
    self.assertNotIn(&#39;*&#39;, minified)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_minify_html"><code class="name flex">
<span>def <span class="ident">test_minify_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L936-L940" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_minify_html(self):
    html = &#39;  &lt;p&gt;   a   &lt;/p&gt;    &lt;pre&gt;    a\n    b&lt;/pre&gt;    c   \n    d   &#39;
    expected = &#39;\n&lt;p&gt;\na\n&lt;/p&gt;\n&lt;pre&gt;    a\n    b&lt;/pre&gt;\nc\nd\n&#39;
    minified = minify_html(html)
    self.assertEqual(minified, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_to_html"><code class="name flex">
<span>def <span class="ident">test_to_html</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L948-L982" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_to_html(self):
        text = &#39;&#39;&#39;# Title

`pdoc.Module` is a `Doc`, not `dict`.

ref with underscore: `_x_x_`

```
code block
```
reference: `package.foo`
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;&lt;h1 id=&#34;title&#34;&gt;Title&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Module&#34;&gt;Module&lt;/a&gt;&lt;/code&gt; is a &lt;code&gt;&lt;a href=&#34;#pdoc.Doc&#34;&gt;Doc&lt;/a&gt;&lt;/code&gt;,\
 not &lt;code&gt;dict&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ref with underscore: &lt;code&gt;&lt;a href=&#34;#pdoc._x_x_&#34;&gt;_x_x_&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;code block
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;reference: &lt;code&gt;&lt;a href=&#34;/package.foo.ext&#34;&gt;package.foo&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;&#39;&#39;

        module = pdoc.Module(pdoc)
        module.doc[&#39;_x_x_&#39;] = pdoc.Variable(&#39;_x_x_&#39;, module, &#39;&#39;)

        def link(dobj):
            return &#39;&lt;a href=&#34;{}&#34;&gt;{}&lt;/a&gt;&#39;.format(dobj.url(relative_to=module), dobj.qualname)

        html = to_html(text, module=module, link=link)
        self.assertEqual(html, expected)

        self.assertEqual(to_html(&#39;`pdoc.Doc.url()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;#pdoc.Doc.url&#34;&gt;Doc.url&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)

        self.assertEqual(to_html(&#39;`foo.f()`&#39;, module=module, link=link),
                         &#39;&lt;p&gt;&lt;code&gt;&lt;a href=&#34;/foo.f().ext&#34;&gt;foo.f()&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;&#39;)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_to_html_refname"><code class="name flex">
<span>def <span class="ident">test_to_html_refname</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L984-L1016" class="git-link">Browse git</a>
</summary>
<pre><code class="python">    def test_to_html_refname(self):
        text = &#39;&#39;&#39;
[`pdoc` x][pdoc] `pdoc`
[x `pdoc`][pdoc] `[pdoc]()`

`__x__`

[`pdoc`](#)
[``pdoc` ``](#)
[```pdoc```](#)

```
pdoc
```

[pdoc]: #pdoc
&#39;&#39;&#39;
        expected = &#39;&#39;&#39;\
&lt;p&gt;&lt;a href=&#34;#pdoc&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt; x&lt;/a&gt; &lt;code&gt;&lt;a&gt;pdoc&lt;/a&gt;&lt;/code&gt;
&lt;a href=&#34;#pdoc&#34;&gt;x &lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt; &lt;code&gt;[&lt;a&gt;pdoc&lt;/a&gt;]()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;__x__&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc`&lt;/code&gt;&lt;/a&gt;
&lt;a href=&#34;#&#34;&gt;&lt;code&gt;pdoc&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pdoc
&lt;/code&gt;&lt;/pre&gt;\
&#39;&#39;&#39;

        def link(dobj):
            return &#39;&lt;a&gt;{}&lt;/a&gt;&#39;.format(dobj.qualname)

        html = to_html(text, module=pdoc.Module(pdoc), link=link)
        self.assertEqual(html, expected)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HtmlHelpersTest.test_to_html_refname_warning"><code class="name flex">
<span>def <span class="ident">test_to_html_refname_warning</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1018-L1028" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_to_html_refname_warning(self):
    mod = pdoc.Module(EXAMPLE_MODULE)

    def f():
        &#34;&#34;&#34;Reference to some `example_pkg.nonexisting` object&#34;&#34;&#34;

    mod.doc[&#39;__f&#39;] = pdoc.Function(&#39;__f&#39;, mod, f)
    with self.assertWarns(ReferenceWarning) as cm:
        mod.html()
    del mod.doc[&#39;__f&#39;]
    self.assertIn(&#39;example_pkg.nonexisting&#39;, cm.warning.args[0])</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pdoc.test.HttpTest"><code class="flex name class">
<span>class <span class="ident">HttpTest</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>Unit tests for the HTTP server functionality.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1351-L1424" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class HttpTest(unittest.TestCase):
    &#34;&#34;&#34;
    Unit tests for the HTTP server functionality.
    &#34;&#34;&#34;
    @contextmanager
    def _timeout(self, secs):
        def _raise(*_):
            raise TimeoutError

        signal.signal(signal.SIGALRM, _raise)
        signal.alarm(secs)
        yield
        signal.alarm(0)

    @contextmanager
    def _http(self, modules: list):
        port = randint(9000, 12000)

        with self._timeout(1000):
            with redirect_streams() as (stdout, stderr):
                t = threading.Thread(
                    target=cli.main,
                    args=(cli.parser.parse_args([&#39;--http&#39;, &#39;:%d&#39; % port] + modules),))
                t.start()
                sleep(.1)

                if not t.is_alive():
                    sys.__stderr__.write(stderr.getvalue())
                    raise AssertionError

                try:
                    yield &#39;http://localhost:{}/&#39;.format(port)
                except Exception:
                    sys.__stderr__.write(stderr.getvalue())
                    sys.__stdout__.write(stdout.getvalue())
                    raise
                finally:
                    pdoc.cli._httpd.shutdown()  # type: ignore
                    t.join()

    def test_http(self):
        with self._http([&#39;pdoc&#39;, os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)]) as url:
            with self.subTest(url=&#39;/&#39;):
                with urlopen(url, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;Python package &lt;code&gt;pdoc&lt;/code&gt;&#39;, html)
                    self.assertNotIn(b&#39;gzip&#39;, html)
            with self.subTest(url=&#39;/&#39; + EXAMPLE_MODULE):
                with urlopen(url + &#39;pdoc&#39;, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;__pdoc__&#39;, html)
            with self.subTest(url=&#39;/csv.ext&#39;):
                with urlopen(url + &#39;csv.ext&#39;, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;DictReader&#39;, html)

    def test_file(self):
        with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
            with self._http([&#39;_relative_import&#39;]) as url:
                with urlopen(url, timeout=3) as resp:
                    html = resp.read()
                    self.assertIn(b&#39;&lt;a href=&#34;/_relative_import&#34;&gt;&#39;, html)

    def test_head(self):
        with self._http([&#39;pdoc&#39;]) as url:
            with urlopen(Request(url + &#39;pdoc/&#39;,
                                 method=&#39;HEAD&#39;,
                                 headers={&#39;If-None-Match&#39;: &#39;xxx&#39;})) as resp:
                self.assertEqual(resp.status, 205)
            with self.assertRaises(HTTPError) as cm:
                urlopen(Request(url + &#39;pdoc/&#39;,
                                method=&#39;HEAD&#39;,
                                headers={&#39;If-None-Match&#39;: str(os.stat(pdoc.__file__).st_mtime)}))
            self.assertEqual(cm.exception.code, 304)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pdoc.test.HttpTest.test_file"><code class="name flex">
<span>def <span class="ident">test_file</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1407-L1412" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_file(self):
    with chdir(os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)):
        with self._http([&#39;_relative_import&#39;]) as url:
            with urlopen(url, timeout=3) as resp:
                html = resp.read()
                self.assertIn(b&#39;&lt;a href=&#34;/_relative_import&#34;&gt;&#39;, html)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HttpTest.test_head"><code class="name flex">
<span>def <span class="ident">test_head</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1414-L1424" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_head(self):
    with self._http([&#39;pdoc&#39;]) as url:
        with urlopen(Request(url + &#39;pdoc/&#39;,
                             method=&#39;HEAD&#39;,
                             headers={&#39;If-None-Match&#39;: &#39;xxx&#39;})) as resp:
            self.assertEqual(resp.status, 205)
        with self.assertRaises(HTTPError) as cm:
            urlopen(Request(url + &#39;pdoc/&#39;,
                            method=&#39;HEAD&#39;,
                            headers={&#39;If-None-Match&#39;: str(os.stat(pdoc.__file__).st_mtime)}))
        self.assertEqual(cm.exception.code, 304)</code></pre>
</details>
</dd>
<dt id="pdoc.test.HttpTest.test_http"><code class="name flex">
<span>def <span class="ident">test_http</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/pdoc3/pdoc/blob/155f4ac9f1238efe229fae7a4ace8da7cfddddbc/pdoc/test/__init__.py#L1391-L1405" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def test_http(self):
    with self._http([&#39;pdoc&#39;, os.path.join(TESTS_BASEDIR, EXAMPLE_MODULE)]) as url:
        with self.subTest(url=&#39;/&#39;):
            with urlopen(url, timeout=3) as resp:
                html = resp.read()
                self.assertIn(b&#39;Python package &lt;code&gt;pdoc&lt;/code&gt;&#39;, html)
                self.assertNotIn(b&#39;gzip&#39;, html)
        with self.subTest(url=&#39;/&#39; + EXAMPLE_MODULE):
            with urlopen(url + &#39;pdoc&#39;, timeout=3) as resp:
                html = resp.read()
                self.assertIn(b&#39;__pdoc__&#39;, html)
        with self.subTest(url=&#39;/csv.ext&#39;):
            with urlopen(url + &#39;csv.ext&#39;, timeout=3) as resp:
                html = resp.read()
                self.assertIn(b&#39;DictReader&#39;, html)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="pdoc Home" href="https://pdoc3.github.io/pdoc/">
<img src="https://pdoc3.github.io/pdoc/logo.png" alt=""> pdoc
</a>
</header>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pdoc" href="../index.html">pdoc</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="pdoc.test.example_pkg" href="example_pkg/index.html">pdoc.test.example_pkg</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="pdoc.test.chdir" href="#pdoc.test.chdir">chdir</a></code></li>
<li><code><a title="pdoc.test.ignore_warnings" href="#pdoc.test.ignore_warnings">ignore_warnings</a></code></li>
<li><code><a title="pdoc.test.redirect_streams" href="#pdoc.test.redirect_streams">redirect_streams</a></code></li>
<li><code><a title="pdoc.test.run" href="#pdoc.test.run">run</a></code></li>
<li><code><a title="pdoc.test.run_html" href="#pdoc.test.run_html">run_html</a></code></li>
<li><code><a title="pdoc.test.temp_dir" href="#pdoc.test.temp_dir">temp_dir</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pdoc.test.ApiTest" href="#pdoc.test.ApiTest">ApiTest</a></code></h4>
<ul class="">
<li><code><a title="pdoc.test.ApiTest.setUp" href="#pdoc.test.ApiTest.setUp">setUp</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Class_docstring" href="#pdoc.test.ApiTest.test_Class_docstring">test_Class_docstring</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Class_params" href="#pdoc.test.ApiTest.test_Class_params">test_Class_params</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Function_params" href="#pdoc.test.ApiTest.test_Function_params">test_Function_params</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Function_return_annotation" href="#pdoc.test.ApiTest.test_Function_return_annotation">test_Function_return_annotation</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Module_find_class" href="#pdoc.test.ApiTest.test_Module_find_class">test_Module_find_class</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Variable_type_annotation" href="#pdoc.test.ApiTest.test_Variable_type_annotation">test_Variable_type_annotation</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_Variable_type_annotation_py35plus" href="#pdoc.test.ApiTest.test_Variable_type_annotation_py35plus">test_Variable_type_annotation_py35plus</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test__all__" href="#pdoc.test.ApiTest.test__all__">test__all__</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test__pdoc__dict" href="#pdoc.test.ApiTest.test__pdoc__dict">test__pdoc__dict</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test__pdoc__invalid_value" href="#pdoc.test.ApiTest.test__pdoc__invalid_value">test__pdoc__invalid_value</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test__pdoc__whitelist" href="#pdoc.test.ApiTest.test__pdoc__whitelist">test__pdoc__whitelist</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_builtin_methoddescriptors" href="#pdoc.test.ApiTest.test_builtin_methoddescriptors">test_builtin_methoddescriptors</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_class_variables_docstring_not_from_obj" href="#pdoc.test.ApiTest.test_class_variables_docstring_not_from_obj">test_class_variables_docstring_not_from_obj</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_context" href="#pdoc.test.ApiTest.test_context">test_context</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_find_ident" href="#pdoc.test.ApiTest.test_find_ident">test_find_ident</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_import_filename" href="#pdoc.test.ApiTest.test_import_filename">test_import_filename</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_imported_once" href="#pdoc.test.ApiTest.test_imported_once">test_imported_once</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_inherited_members" href="#pdoc.test.ApiTest.test_inherited_members">test_inherited_members</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_inherits" href="#pdoc.test.ApiTest.test_inherits">test_inherits</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_instance_var" href="#pdoc.test.ApiTest.test_instance_var">test_instance_var</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_link_inheritance" href="#pdoc.test.ApiTest.test_link_inheritance">test_link_inheritance</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_module" href="#pdoc.test.ApiTest.test_module">test_module</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_module_allsubmodules" href="#pdoc.test.ApiTest.test_module_allsubmodules">test_module_allsubmodules</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_module_init" href="#pdoc.test.ApiTest.test_module_init">test_module_init</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_namespace" href="#pdoc.test.ApiTest.test_namespace">test_namespace</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_qualname" href="#pdoc.test.ApiTest.test_qualname">test_qualname</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_readonly_value_descriptors" href="#pdoc.test.ApiTest.test_readonly_value_descriptors">test_readonly_value_descriptors</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_refname" href="#pdoc.test.ApiTest.test_refname">test_refname</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_sorting" href="#pdoc.test.ApiTest.test_sorting">test_sorting</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_subclasses" href="#pdoc.test.ApiTest.test_subclasses">test_subclasses</a></code></li>
<li><code><a title="pdoc.test.ApiTest.test_url" href="#pdoc.test.ApiTest.test_url">test_url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pdoc.test.CliTest" href="#pdoc.test.CliTest">CliTest</a></code></h4>
<ul class="">
<li><code><a title="pdoc.test.CliTest.ALL_FILES" href="#pdoc.test.CliTest.ALL_FILES">ALL_FILES</a></code></li>
<li><code><a title="pdoc.test.CliTest.PUBLIC_FILES" href="#pdoc.test.CliTest.PUBLIC_FILES">PUBLIC_FILES</a></code></li>
<li><code><a title="pdoc.test.CliTest.setUp" href="#pdoc.test.CliTest.setUp">setUp</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_config" href="#pdoc.test.CliTest.test_config">test_config</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_external_links" href="#pdoc.test.CliTest.test_external_links">test_external_links</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_force" href="#pdoc.test.CliTest.test_force">test_force</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_google_analytics" href="#pdoc.test.CliTest.test_google_analytics">test_google_analytics</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_html" href="#pdoc.test.CliTest.test_html">test_html</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_html_identifier" href="#pdoc.test.CliTest.test_html_identifier">test_html_identifier</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_html_multiple_files" href="#pdoc.test.CliTest.test_html_multiple_files">test_html_multiple_files</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_html_no_source" href="#pdoc.test.CliTest.test_html_no_source">test_html_no_source</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_html_ref_links" href="#pdoc.test.CliTest.test_html_ref_links">test_html_ref_links</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_link_prefix" href="#pdoc.test.CliTest.test_link_prefix">test_link_prefix</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_output_text" href="#pdoc.test.CliTest.test_output_text">test_output_text</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_pdf" href="#pdoc.test.CliTest.test_pdf">test_pdf</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_relative_dir_path" href="#pdoc.test.CliTest.test_relative_dir_path">test_relative_dir_path</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_template_dir" href="#pdoc.test.CliTest.test_template_dir">test_template_dir</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_text" href="#pdoc.test.CliTest.test_text">test_text</a></code></li>
<li><code><a title="pdoc.test.CliTest.test_text_identifier" href="#pdoc.test.CliTest.test_text_identifier">test_text_identifier</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pdoc.test.Docformats" href="#pdoc.test.Docformats">Docformats</a></code></h4>
<ul class="">
<li><code><a title="pdoc.test.Docformats.setUpClass" href="#pdoc.test.Docformats.setUpClass">setUpClass</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_doctests" href="#pdoc.test.Docformats.test_doctests">test_doctests</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_google" href="#pdoc.test.Docformats.test_google">test_google</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_latex_math" href="#pdoc.test.Docformats.test_latex_math">test_latex_math</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_numpy" href="#pdoc.test.Docformats.test_numpy">test_numpy</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_numpy_curly_brace_expansion" href="#pdoc.test.Docformats.test_numpy_curly_brace_expansion">test_numpy_curly_brace_expansion</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_reST_directives" href="#pdoc.test.Docformats.test_reST_directives">test_reST_directives</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_reST_include" href="#pdoc.test.Docformats.test_reST_include">test_reST_include</a></code></li>
<li><code><a title="pdoc.test.Docformats.test_urls" href="#pdoc.test.Docformats.test_urls">test_urls</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pdoc.test.HtmlHelpersTest" href="#pdoc.test.HtmlHelpersTest">HtmlHelpersTest</a></code></h4>
<ul class="">
<li><code><a title="pdoc.test.HtmlHelpersTest.test_extract_toc" href="#pdoc.test.HtmlHelpersTest.test_extract_toc">test_extract_toc</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_format_git_link" href="#pdoc.test.HtmlHelpersTest.test_format_git_link">test_format_git_link</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_glimpse" href="#pdoc.test.HtmlHelpersTest.test_glimpse">test_glimpse</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_minify_css" href="#pdoc.test.HtmlHelpersTest.test_minify_css">test_minify_css</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_minify_html" href="#pdoc.test.HtmlHelpersTest.test_minify_html">test_minify_html</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_to_html" href="#pdoc.test.HtmlHelpersTest.test_to_html">test_to_html</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_to_html_refname" href="#pdoc.test.HtmlHelpersTest.test_to_html_refname">test_to_html_refname</a></code></li>
<li><code><a title="pdoc.test.HtmlHelpersTest.test_to_html_refname_warning" href="#pdoc.test.HtmlHelpersTest.test_to_html_refname_warning">test_to_html_refname_warning</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pdoc.test.HttpTest" href="#pdoc.test.HttpTest">HttpTest</a></code></h4>
<ul class="">
<li><code><a title="pdoc.test.HttpTest.test_file" href="#pdoc.test.HttpTest.test_file">test_file</a></code></li>
<li><code><a title="pdoc.test.HttpTest.test_head" href="#pdoc.test.HttpTest.test_head">test_head</a></code></li>
<li><code><a title="pdoc.test.HttpTest.test_http" href="#pdoc.test.HttpTest.test_http">test_http</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p><span style="color:#ddd">&#21328;</span></p>
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.0</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-43663477-5','auto');ga('require','cleanUrlTracker',{indexFilename:'index.html',trailingSlash:'add'});ga('require','outboundLinkTracker',{events:['click','auxclick','contextmenu']});ga('require','maxScrollTracker');ga('require','pageVisibilityTracker');ga('send','pageview');setTimeout(function(){ga('send','event','pageview','view')},15000);</script><script async src='https://www.google-analytics.com/analytics.js'></script><script async src='https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js'></script></body>
</html>